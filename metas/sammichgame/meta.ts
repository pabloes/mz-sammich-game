export default(function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i,l:0,exports:{}};e[i].call(s.exports,s,s.exports,n);s.l=1;return s.exports}n.m=e;n.c=t;n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:1,get:i})};n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});Object.defineProperty(e,"__esModule",{value:1})};n.t=function(e,t){1&t&&(e=n(e));if(8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);n.r(i);Object.defineProperty(i,"default",{enumerable:1,value:e});if(2&t&&"string"!=typeof e)for(var s in e)n.d(i,s,function(t){return e[t]}.bind(null,s));return i};n.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};n.d(t,"a",t);return t};n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};n.p="";return n(n.s=22)}([function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.getSpriteUv=t.SpriteAnimationSystem=t.createSpriteEntity=void 0;const i=n(1),s={time:.5,frames:[],init:1,position:void 0,scale:void 0};t.createSpriteEntity=(e,{position:t=new Vector3(0,0,0),scale:n=new Vector3(1,1,1),uvs:s})=>{const o=new Entity,r=new PlaneShape;r.withCollisions=0;r.isPointerBlocker=0;const a=new Transform({position:t,scale:n});r.uvs=s;o.addComponent(r);o.addComponent(i.spriteMaterial);o.addComponent(a);o.setParent(e);return{show:()=>{r.visible=1},hide:()=>{r.visible=0},getEntity:()=>o,getShape:()=>r,getTransform:()=>a,updateUvs:e=>r.uvs=e}};class o{constructor(e,t=s){const{scale:n,time:o,position:r,frames:a,init:l}=t;this.globalOptions=Object.assign(Object.assign({},s),t);this.root=e;this.setInitialState();this.sprite=new Entity;this.plane=new PlaneShape;this.sprite.addComponent(i.spriteMaterial);this.sprite.addComponent(this.plane);(r||n)&&this.sprite.addComponent(new Transform({scale:n,position:r}));this.plane.uvs=a[0].uvs;engine.addSystem(this)}setPosition(e){this.sprite.getComponent(Transform).position.set(e.x,e.y,e.z)}getPosition(){return this.sprite.getComponent(Transform).position}setRotation(e){this.sprite.getComponent(Transform).rotation.setEuler(0,0,e)}addComponentOrReplace(e){this.sprite.addComponentOrReplace(e)}addComponent(e){this.sprite.addComponent(e)}removeComponent(e){this.sprite.removeComponent(e)}init(){this.state.initialized=1;this.sprite.setParent(this.root)}nextFrame(){this.state.currentFrame++;this.state.currentFrame>=this.state.playtrack.length-1&&this.state.playing&&!this.state.loop&&(this.state.playing=0);this.state.currentFrame>=this.state.playtrack.length&&(this.state.loop?this.state.currentFrame=0:this.state.currentFrame=this.state.playtrack.length-1);this.plane.uvs=this.globalOptions.frames[this.state.playtrack[this.state.currentFrame]].uvs}update(e){if(this.state.initialized)if(this.state.playing){this.state.dtCount+=e;if(this.state.dtCount>=this.state.time){this.state.dtCount=0;this.nextFrame()}}else this.state.dtCount=0}play(e,t){this.state.playtrack=e;this.state.dtCount=0;this.state.currentFrame=-1;this.state.initialized=1;this.state.playing=1;this.state.end=e.length-1;this.state.time=(null==t?void 0:t.time)||this.globalOptions.time;this.state.loop=(null==t?void 0:t.loop)||0;this.nextFrame()}stop(e=0){this.plane.uvs=this.globalOptions.frames[0].uvs;this.state.playing=0}destroy(){engine.removeSystem(this)}setInitialState(){this.state={initialized:0,playing:0,currentFrame:0,dtCount:0,start:0,end:0,loop:0,time:this.globalOptions.time||.5,playtrack:[0]}}resetState(){this.state=Object.assign(Object.assign({},this.state),{playing:0})}}t.SpriteAnimationSystem=o;t.getSpriteUv=(e,t=0,n=64,i=n)=>{let s=1024/n,o=1024/i,r=e+t,a=1/s,l=1/o,c=o-Math.floor((r-1)/s),h=Math.floor((r-1)%s);const u=h*a,d=(h+1)*a,p=(c-1)*l,m=c*l;return[0,0,0,0,0,0,0,0,d,p,u,p,u,m,d,m]}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.loadTexture=t.spriteMaterial=void 0;t.spriteMaterial=new Material;t.loadTexture=()=>{const e=(engine["RESOURCE_BASE"]||globalThis["RESOURCE_BASE"]||"")+"images/sprite3.png",n=new Texture(e,{samplingMode:0,hasAlpha:1});t.spriteMaterial.albedoTexture=n;t.spriteMaterial.alphaTexture=n;t.spriteMaterial.emissiveTexture=n};void 0;const i=(engine["RESOURCE_BASE"]||globalThis["RESOURCE_BASE"]||"")+"images/sprite3.png";void 0;t.spriteMaterial.emissiveIntensity=.5;t.spriteMaterial.emissiveColor=new Color3(1,1,1);t.spriteMaterial.transparencyMode=1;t.spriteMaterial.specularIntensity=0;t.spriteMaterial.roughness=1},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.removeSoundsFromEntity=t.addSoundsToEntity=t.stopAllSounds=t.stopSound=t.isMusic=t.playOnce=t.playLoop=t.isPlaying=t.toggleMusic=t.setTotalMute=t.loadSounds=void 0;let i={},s=[];t.loadSounds=()=>{const e=""+(engine["RESOURCE_BASE"]||globalThis["RESOURCE_BASE"]||""),t=new AudioClip(e+"sounds/error.mp3"),n=new AudioClip(e+"sounds/music2b.mp3"),o=new AudioClip(e+"sounds/vs.mp3"),r=new AudioClip(e+"sounds/pwned.mp3"),a=new AudioClip(e+"sounds/race.mp3"),l=new AudioClip(e+"sounds/ok.mp3"),c=new AudioClip(e+"sounds/wow.mp3"),h=new AudioClip(e+"sounds/swing.mp3"),u=new AudioClip(e+"sounds/battle.mp3"),d=new AudioClip(e+"sounds/money.mp3"),p=new AudioClip(e+"sounds/jump.mp3"),m=new AudioClip(e+"sounds/readygo.mp3"),g=new AudioClip(e+"sounds/hit.mp3"),S=new AudioSource(t),y=new AudioSource(n),f=new AudioSource(o),T=new AudioSource(r),b=new AudioSource(a),w=new AudioSource(l),v=new AudioSource(c),C=new AudioSource(h),P=new AudioSource(u),R=new AudioSource(d),E=new AudioSource(p),_=new AudioSource(m),I=new AudioSource(g);i={fail:S,music2:y,vs:f,pwned:T,race:b,ok:w,wow:v,swing:C,battle:P,money:R,jump:E,readygo:_,hit:I};s=[i.music2,i.pwned,i.race,i.battle,i.money];s.forEach(e=>{e.volume=.5})};const o={music:1,fx:1,totalMute:0};t.setTotalMute=e=>{o.totalMute=e;e?Object.values(i).forEach(e=>{e.volume=0}):Object.values(i).forEach(e=>{t.isMusic(e)?e.volume=o.music?.5:0:e.volume=1})};t.toggleMusic=()=>{o.music=!o.music;s.forEach(e=>{e.volume=!o.music||o.totalMute?0:.5})};t.isPlaying=e=>i[e].playing;t.playLoop=(e,{volume:t}={volume:void 0})=>{i[e].loop=1;i[e].playing=1};t.playOnce=(e,{volume:t}={volume:void 0})=>{i[e].playOnce();void 0===t||~s.indexOf(i[e])||(i[e].volume=t)};t.isMusic=e=>~s.indexOf(e);t.stopSound=e=>{i[e].playing=0};t.stopAllSounds=()=>{Object.values(i).forEach(e=>e.playing=0)};t.addSoundsToEntity=e=>{Object.values(i).forEach(t=>{const n=new Entity;n.setParent(e);n.addComponent(t);t.volume=1})};t.removeSoundsFromEntity=e=>{Object.values(i).forEach(e=>{})}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.seedGen=void 0;t.seedGen={create:e=>{let t=e;return{random:()=>{t=16807*t%2147483647;return t/2147483647}}}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.sleep=t.createUI=t.createRoundResult=t.createTimeResult=t.createPlayerAnswer=void 0;const i=n(0),s={player1:{correct:1,wrong:3},player2:{correct:2,wrong:4}},o=2068;t.createPlayerAnswer=(e,{player:t,size:n=16})=>{const r=new Entity;r.addComponent(new Transform({scale:new Vector3(.5,.5,1),position:new Vector3(1===t?-.3:.3,-10,-.01)}));const a=i.createSpriteEntity(r,{uvs:i.getSpriteUv(s["player"+t].correct,o,16,16),position:new Vector3(0,0,-.001)});r.setParent(e);const l=e=>{let n=5;n=e?s["player"+t].correct:s["player"+t].wrong;a.getShape().uvs=i.getSpriteUv(n,o,16,16)},c=()=>{a.getShape().visible=1},h=()=>{a.getShape().visible=0};return{wrapperEntity:r,sprite:a,setSprite:l,show:c,hide:h}};t.createTimeResult=(e,{player:t,position:n=new Vector3(1===t?-2.4:2.4,.1,-.007),fontSize:s=2.5})=>{const o=new Entity,r=new TextShape,a=i.createSpriteEntity(o,{uvs:i.getSpriteUv(25,2048,16,16),scale:new Vector3(.25,.25,1),position:new Vector3(1===t?-.25:.25,.125,0)});r.isPointerBlocker=0;r.hTextAlign=1===t?"left":"right";r.vTextAlign="bottom";r.fontSize=s;r.font=new Font(Fonts.SanFrancisco_Heavy);r.shadowOffsetX=2;r.shadowOffsetY=2;r.shadowColor=Color3.FromHexString("#000000");r.withCollisions=0;const l=new Transform({position:n});o.addComponent(l);o.addComponent(r);o.setParent(e);const c=undefined,h=undefined,u=undefined;return{show:()=>{r.visible=1;a.getShape().visible=1},hide:()=>{r.visible=0;r.value="";a.getShape().visible=0},update:e=>{r.value=(Math.floor(1e4*e)/1e4/1e3).toString()},getTransform:()=>l,getEntity:()=>o}};t.createRoundResult=(e,{player:t,position:n=new Vector3(1===t?-2:2,3,-.007)})=>{const s=104,o=4/128/2,r=i.createSpriteEntity(e,{uvs:i.getSpriteUv(12,s,128,32),scale:new Vector3(128*o,32*o,1),position:n}),a=undefined,l=undefined,c=undefined;return{show:()=>{r.getShape().visible=1},hide:()=>{r.getShape().visible=0},update:e=>{r.getShape().uvs=e?i.getSpriteUv(12,s,128,32):i.getSpriteUv(4,s,128,32)},getTransform:()=>r.getTransform(),getEntity:()=>r.getEntity()}};t.createUI=(e,{position:n}={position:void 0})=>{const s=t.createTimeResult(e,{player:1}),o=t.createTimeResult(e,{player:2});s.hide();o.hide();const r=new TextShape("0"),a=new TextShape("0");r.withCollisions=a.withCollisions=0;r.isPointerBlocker=a.isPointerBlocker=0;r.font=a.font=new Font(Fonts.SanFrancisco_Heavy);r.fontSize=a.fontSize=2.5;r.vTextAlign=a.vTextAlign="bottom";r.hTextAlign="right";a.hTextAlign="left";const l=new Entity,c=new Entity;l.addComponent(r);l.addComponent(new Transform({position:new Vector3(-.5,n?.1+n.y:.1,-.003)}));c.addComponent(a);c.addComponent(new Transform({position:new Vector3(.5,n?.1+n.y:.1,-.003)}));l.setParent(e);c.setParent(e);const h=i.createSpriteEntity(e,{position:new Vector3(0,n?.5+n.y:.5,-.001),scale:new Vector3(6,1,1),uvs:i.getSpriteUv(2,64,192,32)}),u=undefined,d=undefined,p=undefined,m=undefined,g=undefined,S=undefined,y=undefined;return{updateTime:({player:e,time:t})=>{if(1===e){s.update(t);s.show()}else{o.update(t);o.show()}},updateScore:({player:e,score:t})=>{"undefined"!=typeof t&&(1===e?r.value=t.toString():a.value=t.toString())},hideTime:()=>{s.hide();o.hide()},showTime:()=>{},hideScore:()=>{r.value=a.value=""},show:()=>{h.getShape().visible=1},hide:()=>{h.getShape().visible=0}}};function r(e){return new Promise(t=>setTimeout(t,e))}t.sleep=r},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.TransformSystem=void 0;const i=n(10),s=n(14),o=n(15),r=n(16),a=n(17);class l{constructor(){this._components=[];l._instance=this;this._components.push(i.MoveTransformComponent);this._components.push(s.RotateTransformComponent);this._components.push(o.ScaleTransformComponent);this._components.push(r.FollowPathComponent);this._components.push(a.KeepRotatingComponent)}static createAndAddToEngine(){if(null==this._instance){this._instance=new l;engine.addSystem(this._instance)}return this._instance}static registerCustomComponent(e){this.createAndAddToEngine()._components.push(e)}update(e){this._components.forEach(t=>{this.updateComponent(e,t)})}updateComponent(e,t){const n=undefined;engine.getComponentGroup(t,Transform).entities.forEach(n=>{const i=n.getComponent(Transform),s=n.getComponent(t);s.update(e);s.assignValueToTransform(i);if(s.hasFinished()){n.removeComponent(s);null!=s.onFinishCallback&&s.onFinishCallback()}})}}t.TransformSystem=l;l._instance=null},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.getTimeSinceStart=void 0;t.getTimeSinceStart=e=>Date.now()-e},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.showSpritePanel=t.hideSpritePanel=t.updateSpritePanel=t.createSpritePanel=void 0;const i=n(0),s=n(1),o=new PlaneShape;o.withCollisions=0;o.isPointerBlocker=0;const r=new Transform({position:new Vector3(0,2,-.001),scale:new Vector3(6,4,1)});t.createSpritePanel=e=>{const t=new Entity;t.addComponent(o);t.addComponent(s.spriteMaterial);t.addComponent(r);t.setParent(e)};t.updateSpritePanel=({uvs:e=null,width:t=null,height:n=null,col:s=null,row:a=null,canvasWidth:l=null,scale:c=null})=>{o.uvs=e||i.getSpriteUv(1024/t*a+s,0,t,n);l&&r.scale.set(l,r.scale.y,r.scale.z);c?r.scale.set(c.x,c.y,c.z):r.scale.set(6,4,1)};t.hideSpritePanel=()=>{o.visible=0;r.scale.set(6,4,1)};t.showSpritePanel=()=>{o.visible=1}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.PART_TYPE_OFFSET_Y=t.PART_OFFSET_INDEX=t.PART_SIZE_HEIGHT=t.PART_SIZE_WIDTH=void 0;t.PART_SIZE_WIDTH={shirt:64,pants:64,hair:64,glasses:64};t.PART_SIZE_HEIGHT={shirt:64,pants:64,hair:64,glasses:64};t.PART_OFFSET_INDEX={shirt:64,pants:80,hair:224,glasses:208};t.PART_TYPE_OFFSET_Y={shirt:-.2,pants:.2,hair:0,glasses:0}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.Interpolate=t.InterpolationType=void 0;var i;(function(e){e[e["LINEAR"]=0]="LINEAR";e[e["EASEINQUAD"]=1]="EASEINQUAD";e[e["EASEOUTQUAD"]=2]="EASEOUTQUAD";e[e["EASEQUAD"]=3]="EASEQUAD"})(i=t.InterpolationType||(t.InterpolationType={}));function s(e,t){switch(e){case i.LINEAR:return o(t);case i.EASEINQUAD:return r(t);case i.EASEOUTQUAD:return a(t);case i.EASEQUAD:return l(t);default:return o(t)}}t.Interpolate=s;function o(e){return e}function r(e){return e*e}function a(e){return e*(2-e)}function l(e){return e*e/(2*(e*e-e)+1)}},function(e,t,n){var i=this&&this.__decorate||function(e,t,n,i){var s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i,r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:1});t.MoveTransformComponent=void 0;const s=n(5),o=n(9);let r=class e{constructor(e,t,n,i,r=o.InterpolationType.LINEAR){this.start=e;this.end=t;this.normalizedTime=0;this.lerpTime=0;this.onFinishCallback=i;this.interpolationType=r;if(0!=n)this.speed=1/n;else{this.speed=0;this.normalizedTime=1;this.lerpTime=1}s.TransformSystem.createAndAddToEngine()}update(e){this.normalizedTime=Scalar.Clamp(this.normalizedTime+e*this.speed,0,1);this.lerpTime=o.Interpolate(this.interpolationType,this.normalizedTime)}hasFinished(){return this.normalizedTime>=1}assignValueToTransform(e){e.position=Vector3.Lerp(this.start,this.end,this.lerpTime)}};r=i([Component("moveTransformComponent")],r);t.MoveTransformComponent=r},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.TimerSystem=void 0;const i=n(19),s=n(18),o=n(20);class r{constructor(){this._components=[];r._instance=this;this._components.push(i.Interval);this._components.push(s.Delay);this._components.push(o.ExpireIn)}static createAndAddToEngine(){if(null==this._instance){this._instance=new r;engine.addSystem(this._instance)}return this._instance}static registerCustomComponent(e){this.createAndAddToEngine()._components.push(e)}update(e){this._components.forEach(t=>{this.updateComponent(e,t)})}updateComponent(e,t){let n=engine.getEntitiesWithComponent(t);for(const i in n)if(n.hasOwnProperty(i)){let s=n[i],o=s.getComponent(t);o.elapsedTime+=e;o.elapsedTime>=o.targetTime&&o.onTargetTimeReached(s)}}}t.TimerSystem=r;r._instance=null},function(e,t,n){var i=this&&this.__decorate||function(e,t,n,i){var s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i,r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:1});t.BaseGame=t.GameScene=void 0;let s=class e{};s=i([Component("game_scene")],s);t.GameScene=s;class o{constructor(){this.entity={};this.callbacks={onFinish:null,onShareState:null};const e=engine.getEntitiesWithComponent("game_scene");void 0;Object.keys(e).forEach(t=>{engine.removeEntity(e[t])})}init(){}destroy(){}block(){}onFinish(e){this.callbacks.onFinish=e;return()=>this.callbacks.onFinish=null}onShareState(){}shareState(e){}update(e){}}t.BaseGame=o},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.getTextPanelValue=t.updateTextPanel=t.createTextPanel=void 0;let i=null;const s=new Transform({position:new Vector3(0,4,-.01)});t.createTextPanel=(e,t)=>{const n=new Entity;i=new TextShape;i.value=t;i.vTextAlign="top";i.fontSize=3;i.font=new Font(Fonts.SanFrancisco_Heavy);i.shadowOffsetX=2;i.shadowOffsetY=2;i.shadowColor=Color3.FromHexString("#000000");n.addComponent(s);n.addComponent(i);n.setParent(e)};t.updateTextPanel=e=>{if(e.bottom){i.vTextAlign="bottom";s.position.set(s.position.x,0,s.position.z)}else{i.vTextAlign="top";s.position.set(s.position.x,4,s.position.z)}if("left"===e.hTextAlign){i.hTextAlign="left";s.position.set(-3,s.position.y,s.position.z)}else{i.hTextAlign="center";s.position.set(0,s.position.y,s.position.z)}i.color=e.color||Color3.White();Object.assign(i,{hTextAlign:"center"},e,{value:""+e.value})};t.getTextPanelValue=()=>i.value},function(e,t,n){var i=this&&this.__decorate||function(e,t,n,i){var s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i,r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:1});t.RotateTransformComponent=void 0;const s=n(5),o=n(9);let r=class e{constructor(e,t,n,i,r=o.InterpolationType.LINEAR){this.start=e;this.end=t;this.normalizedTime=0;this.lerpTime=0;this.onFinishCallback=i;this.interpolationType=r;if(0!=n)this.speed=1/n;else{this.speed=0;this.normalizedTime=1;this.lerpTime=1}s.TransformSystem.createAndAddToEngine()}update(e){this.normalizedTime=Scalar.Clamp(this.normalizedTime+e*this.speed,0,1);this.lerpTime=o.Interpolate(this.interpolationType,this.normalizedTime)}hasFinished(){return this.normalizedTime>=1}assignValueToTransform(e){e.rotation=Quaternion.Slerp(this.start,this.end,this.lerpTime)}};r=i([Component("rotateTransformComponent")],r);t.RotateTransformComponent=r},function(e,t,n){var i=this&&this.__decorate||function(e,t,n,i){var s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i,r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:1});t.ScaleTransformComponent=void 0;const s=n(5),o=n(9);let r=class e{constructor(e,t,n,i,r=o.InterpolationType.LINEAR){this.start=e;this.end=t;this.normalizedTime=0;this.lerpTime=0;this.onFinishCallback=i;this.interpolationType=r;if(0!=n)this.speed=1/n;else{this.speed=0;this.normalizedTime=1;this.lerpTime=1}s.TransformSystem.createAndAddToEngine()}update(e){this.normalizedTime=Scalar.Clamp(this.normalizedTime+e*this.speed,0,1);this.lerpTime=o.Interpolate(this.interpolationType,this.normalizedTime)}hasFinished(){return this.normalizedTime>=1}assignValueToTransform(e){e.scale=Vector3.Lerp(this.start,this.end,this.lerpTime)}};r=i([Component("scaleTransformComponent")],r);t.ScaleTransformComponent=r},function(e,t,n){var i=this&&this.__decorate||function(e,t,n,i){var s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i,r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:1});t.FollowPathComponent=void 0;const s=n(5);let o=class e{constructor(e,t,n,i){this.speed=[];this.normalizedTime=0;this.currentIndex=0;this.points=e;this.onFinishCallback=n;this.onPointReachedCallback=i;if(e.length<2)throw new Error("At least 2 points are needed for FollowPathComponent.");if(t>0){let n=0,i=[];for(let t=0;t<e.length-1;t++){let s=Vector3.DistanceSquared(e[t],e[t+1]);n+=s;i.push(s)}for(let e=0;e<i.length;e++)this.speed.push(1/(i[e]/n*t))}else{this.normalizedTime=1;this.currentIndex=e.length-2}s.TransformSystem.createAndAddToEngine()}update(e){this.normalizedTime=Scalar.Clamp(this.normalizedTime+e*this.speed[this.currentIndex],0,1);if(this.normalizedTime>=1&&this.currentIndex<this.points.length-2){this.currentIndex++;this.normalizedTime=0;this.onPointReachedCallback&&this.currentIndex<this.points.length-1&&this.onPointReachedCallback(this.points[this.currentIndex],this.points[this.currentIndex+1])}}hasFinished(){return this.currentIndex>=this.points.length-2&&this.normalizedTime>=1}assignValueToTransform(e){e.position=Vector3.Lerp(this.points[this.currentIndex],this.points[this.currentIndex+1],this.normalizedTime)}};o=i([Component("followPathComponent")],o);t.FollowPathComponent=o},function(e,t,n){var i=this&&this.__decorate||function(e,t,n,i){var s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i,r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:1});t.KeepRotatingComponent=void 0;const s=n(5);let o=class e{constructor(e,t){this.rotationVelocity=e;this.onFinishCallback=t;this.rotation=Quaternion.Identity;this.finished=0;s.TransformSystem.createAndAddToEngine()}update(e){this.rotation=Quaternion.Slerp(Quaternion.Identity,this.rotationVelocity,e)}hasFinished(){return this.finished}assignValueToTransform(e){e.rotation=e.rotation.multiply(this.rotation)}stop(){this.finished=1}};o=i([Component("keepRotatingComponent")],o);t.KeepRotatingComponent=o},function(e,t,n){var i=this&&this.__decorate||function(e,t,n,i){var s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i,r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:1});t.Delay=void 0;const s=n(11);let o=class e{constructor(e,t){s.TimerSystem.createAndAddToEngine();this.elapsedTime=0;this.targetTime=e/1e3;this.onTimeReachedCallback=t;this.onTargetTimeReached=e=>{this.onTimeReachedCallback&&this.onTimeReachedCallback();e.removeComponent(this)}}setCallback(e){this.onTimeReachedCallback=e}};o=i([Component("timerDelay")],o);t.Delay=o},function(e,t,n){var i=this&&this.__decorate||function(e,t,n,i){var s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i,r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:1});t.Interval=void 0;const s=n(11);let o=class e{constructor(e,t){s.TimerSystem.createAndAddToEngine();this.elapsedTime=0;this.targetTime=e/1e3;this.onTimeReachedCallback=t;this.onTargetTimeReached=()=>{this.elapsedTime=0;this.onTimeReachedCallback&&this.onTimeReachedCallback()}}setCallback(e){this.onTimeReachedCallback=e}};o=i([Component("timerInterval")],o);t.Interval=o},function(e,t,n){var i=this&&this.__decorate||function(e,t,n,i){var s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i,r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:1});t.ExpireIn=void 0;const s=n(11);let o=class e{constructor(e,t){s.TimerSystem.createAndAddToEngine();this.elapsedTime=0;this.targetTime=e/1e3;this.onTimeReachedCallback=t;this.onTargetTimeReached=e=>{this.onTimeReachedCallback&&this.onTimeReachedCallback();e.removeComponent(this);engine.removeEntity(e)}}setCallback(e){this.onTimeReachedCallback=e}};o=i([Component("timerExpireIn")],o);t.ExpireIn=o},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.createCross=void 0;const i=n(1),s=n(0);t.createCross=(e,{position:t,scale:n})=>{const o=new Entity,r=new PlaneShape;r.withCollisions=0;o.addComponent(i.spriteMaterial);r.uvs=s.getSpriteUv(993,0,32);o.addComponent(r);const a=new Transform({position:t,scale:n});o.addComponent(a);o.setParent(e);return{dispose:()=>{o.setParent(null);engine.removeEntity(o);o.removeComponent(i.spriteMaterial);o.removeComponent(a);o.removeComponent(r)},hide:()=>{r.visible=0},show:()=>{r.visible=1},setPosition:({x:e,y:t,z:n})=>{a.position.set(e,t,n)}}}},function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:1});const s=i(n(23));engine["PRODI"]=1;const o=s.default.CostumeGame,r=2222222231;void 0;let a;class l{constructor(e,t){this.state={countToCheckCamera:0};var n=new Entity,i=new BoxShape;n.addComponent(new Transform({position:new Vector3(8,1,8)}));n.addComponent(i);engine.addEntity(n)}update(e){}refreshHost(e){}}t.default=l},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});const i=n(24),s=n(29),o=n(30),r=n(38),a=n(40),l=n(41),c=n(43),h=n(44);t.default={DifferentGame:c.DifferentGame,AttackGame:s.AttackGame,RotationGame:i.RotationGame,CostumeGame:o.CostumeGame,ObstacleGame:r.ObstacleGame,MathGame:a.MathGame,SammichGame:l.SammichGame,FroggerGame:h.FroggerGame}},function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:1});t.RotationGame=void 0;const s=i(n(25)),o=n(3),r=n(12),a=n(6),l=n(1),c=n(7),h=n(2),u=n(0),d=n(4),p=5;class m{constructor(e,{currentPlayer:t,seed:n,level:i=1,gameIndex:s}){this.state={startTime:Number.MAX_VALUE,roundStartTime:Number.MAX_VALUE,lastRoundStartTime:Number.MAX_VALUE,waitingRound:0,started:0,roundStarted:0,round:0,finished:0,score1:0,score2:0,idle:1,currentRotation:0,answered:0};this.entity={};this.callbacks={onFinish:null,onShareState:null,onFinishRound:null};this.root=e;this.gameSetup={currentPlayer:t,seed:n,level:i,gameIndex:s};this.randomizer=o.seedGen.create(n.toString());this.scene=new Entity;this.scene.addComponent(new Transform({position:new Vector3(0,0,-.002)}));this.ui=d.createUI(this.scene);this.scene.addComponent(new r.GameScene);this.player1=d.createPlayerAnswer(this.scene,{player:1});this.player2=d.createPlayerAnswer(this.scene,{player:2});this.player1.hide();this.player2.hide();this.roundResult1=d.createRoundResult(this.scene,{player:1});this.roundResult2=d.createRoundResult(this.scene,{player:2});this.roundResult1.hide();this.roundResult2.hide();const a=this.entity.image=new Entity,c=undefined;g(this.entity.box=new Entity,l.spriteMaterial,u.getSpriteUv(10,144,64,64));g(a,l.spriteMaterial,u.getSpriteUv(9,144,64,64));this.state.rotationSerie=this.getRotationSerie(this.gameSetup.level);this.state.solution=this.state.rotationSerie.reduce((e,t)=>e+t,0);const h=this.state.correctSolution=this.getRandomInt(1,3);this.state.solutions=[1,2,3].map(e=>e===h?this.state.solution:90*this.getRandomInt(1,4,this.state.solution/90));this.entity.solutions=this.state.solutions.map((e,t)=>{const n=new Entity;this.buildSolution(n,t,e);n.setParent(this.scene);return n});engine.addSystem(this);this.onClickAnswer=this.onClickAnswer.bind(this);this.buildSolution=this.buildSolution.bind(this)}setStartTime(e){this.state.startTime=e}setRoundStartTime(e){this.state.roundStartTime=e}reset(){}getRotationSerie(e){let t=3;e>=3&&e<5?t=4:e>=5&&(t=5);let n=t;const i=[];for(;n--;){const e=this.randomizer.random();i.push(Math.floor(2*e)?90:-90)}return i}finish({winner:e}){this.state.blocked=1;const t=1===e?2:1;e===this.gameSetup.currentPlayer?h.playOnce("wow"):h.playOnce("fail");this.roundResult1.show();this.roundResult2.show();this["roundResult"+e].update(1);this["roundResult"+t].update(0)}finishRound({winner:e}){this.state.blocked=1;const t=1===e?2:1;this.state["score"+e]+=1;this.ui.updateScore({player:e,score:this.state["score"+e]});e===this.gameSetup.currentPlayer?h.playOnce("wow"):h.playOnce("fail");this.entity.box.getComponent(Transform).rotation.setEuler(0,0,0);this.entity.box.getComponent(PlaneShape).visible=0;this.entity.image.getComponent(PlaneShape).visible=1;this["roundResult"+e].update(1);this["roundResult"+t].update(0);this.roundResult1.show();this.roundResult2.show();this.state.waitingRound=1}shareState(e){this.state.shared=e;const{round:t}=e;if(t===this.state.round&&"election"===e.type&&e.player!==this.gameSetup.currentPlayer){const{x:t,y:n,z:i}=this.entity.solutions[e.election-1].getComponent(Transform).position,s=this.getIsWinner(this.state,e.election);this["player"+e.player].wrapperEntity.getComponent(Transform).position.set(t+(1===e.player?-.3:.3),n,i);this["player"+e.player].show();this["player"+e.player].setSprite(s);this.ui.updateTime({player:e.player,time:e.timeSinceAnswers})}}onShareState(e){this.callbacks.onShareState=e;return()=>this.callbacks.onShareState=null}init(){h.playLoop("money",{volume:.5});c.updateSpritePanel({uvs:u.getSpriteUv(2,0,192,128)});c.showSpritePanel();this.entity.image.setParent(this.scene);this.entity.box.setParent(this.scene);this.entity.box.getComponent(PlaneShape).visible=0;this.state.initialized=1;this.scene.setParent(this.root)}destroy(){h.stopSound("money");c.hideSpritePanel();this.scene.setParent(null);engine.removeEntity(this.scene);engine.removeSystem(this);this.callbacks.onFinish=null;this.callbacks.onShareState=null}update(e){if(!this.state.initialized)return;const t=this.state.round<2?.4:this.state.round<3?.3:.2,n=.2;if(!this.state.started&&Date.now()>=this.state.startTime)this.start(e);else if(!this.state.started||this.state.waitingRound||this.state.roundStarted){if(this.state.started&&!this.state.waitingRound&&this.state.roundStarted){this.state.nextTime+=e;if(this.state.nextTime>=t+n){this.state.nextTime=0;if(this.state.currentRotation<this.state.rotationSerie.length){const e=Quaternion.Euler(0,0,0),n=Quaternion.Euler(0,0,this.state.rotationSerie[this.state.currentRotation]);h.playOnce("swing");this.entity.box.addComponentOrReplace(new s.default.RotateTransformComponent(e,n,t));this.state.nextTime=0;this.state.currentRotation++;this.entity.solutions.forEach(e=>e.getComponent(PlaneShape).visible=0);this.state.answersShown=0}else if(!this.state.waitingRound&&!this.state.answersShown){this.state.blocked=0;this.state.answersShown=1;this.state.shownAnswersTime=Date.now();this.entity.solutions.forEach(e=>e.getComponent(PlaneShape).visible=1)}}}}else{this.state.nextTime+=e;if(this.state.nextTime>=t+n){this.state.nextTime=0;if(this.state.currentRotation<this.state.rotationSerie.length){const e=Quaternion.Euler(0,0,0),n=Quaternion.Euler(0,0,this.state.rotationSerie[this.state.currentRotation]);h.playOnce("swing");this.entity.box.addComponentOrReplace(new s.default.RotateTransformComponent(e,n,t));this.state.nextTime=0;this.state.currentRotation++;this.entity.solutions.forEach(e=>e.getComponent(PlaneShape).visible=0);this.state.answersShown=0}else if(!this.state.waitingRound&&!this.state.answersShown){this.state.answersShown=1;this.state.shownAnswersTime=Date.now();this.entity.solutions.forEach(e=>e.getComponent(PlaneShape).visible=1)}}}this.state.started&&this.state.waitingRound&&Date.now()>=this.state.roundStartTime&&this.startRound()}block(){this.state.blocked=1}start(e){setTimeout(()=>{this.state.idle=0;this.state.started=1;this.state.finished=0;this.state.nextTime=0;this.entity.box.getComponent(PlaneShape).visible=1;this.entity.image.getComponent(PlaneShape).visible=0},1e3)}startRound(){this.state.round++;this.ui.hideTime();this.entity.solutions.forEach(e=>{e.getComponent(PlaneShape).visible=0});this.player1.hide();this.player2.hide();this.roundResult1.hide();this.roundResult2.hide();this.state.lastRoundStartTime=this.state.roundStartTime;this.state.roundStartTime=Number.MAX_VALUE;setTimeout(()=>{this.state.blocked=0;this.state.waitingRound=0;this.state.answered=0;this.state.roundStarted=1;this.state.nextTime=0;this.entity.box.getComponent(PlaneShape).visible=1;this.entity.image.getComponent(PlaneShape).visible=0;this.state.rotationSerie=this.getRotationSerie(this.state.round+1);this.state.solution=this.state.rotationSerie.reduce((e,t)=>e+t,0);const e=this.state.correctSolution=this.getRandomInt(1,3);this.state.solutions=[1,2,3].map(t=>t===e?this.state.solution:90*this.getRandomInt(1,4,this.state.solution/90));this.state.currentRotation=0;this.entity.solutions.forEach((e,t)=>{e.getComponent(Transform).rotation.setEuler(0,0,0);e.getComponent(Transform).rotate(new Vector3(0,0,1),this.state.solutions[t])})},1e3/(500*this.state.round)*1e3)}onFinish(e){this.callbacks.onFinish=e;return()=>this.callbacks.onFinish=null}onFinishRound(e){this.callbacks.onFinishRound=e;return()=>this.callbacks.onFinishRound=null}getIsWinner(e,t){const n=this.entity.solutions[t-1],i=undefined;if(s(this.entity.solutions[e.correctSolution-1])===s(n))return 1;void 0;return 0;function s(e){const t=Math.round(e.getComponent(Transform).rotation.eulerAngles.z)%360;return t<0?360-t:t}}buildSolution(e,t,n){const i=new PlaneShape;i.visible=0;i.withCollisions=0;const s={x:1.1*t-1.1,y:1.15,z:0},o=new Transform({position:new Vector3(s.x,s.y,s.z),scale:new Vector3(1,1,1e-7)});o.rotate(new Vector3(0,0,1),n);e.addComponent(l.spriteMaterial);i.withCollisions=0;i.uvs=u.getSpriteUv(12,480,32,32);e.addComponent(i);e.addComponent(o);this.gameSetup.currentPlayer&&e.addComponent(new OnClick(()=>this.onClickAnswer(e,s,t)))}onClickAnswer(e,t,n){if(this.state.answered)return;if(this.state.blocked)return;if(!this.state.initialized)return;if(this.state.finished)return;h.playOnce("swing");this["player"+this.gameSetup.currentPlayer].wrapperEntity.getComponent(Transform).position.set(t.x+(1===this.gameSetup.currentPlayer?-.2:.2),t.y,t.z);this["player"+this.gameSetup.currentPlayer].show();this.state.blocked=1;this.state.answered=1;const i=this.getIsWinner(this.state,n+1);this["player"+this.gameSetup.currentPlayer].setSprite(i);const s=a.getTimeSinceStart(0===this.state.round?this.state.startTime:this.state.lastRoundStartTime),o=i?s:999999999-s,r=Date.now()-this.state.shownAnswersTime;this.ui.updateTime({player:this.gameSetup.currentPlayer,time:r});this.callbacks.onShareState({type:"election",player:this.gameSetup.currentPlayer,election:n+1,time:s,timeSinceAnswers:r,round:this.state.round});this.state.round<p-1?this.callbacks.onFinishRound({time:o,player:this.gameSetup.currentPlayer,gameIndex:this.gameSetup.gameIndex,roundIndex:this.state.round}):this.callbacks.onFinish({time:o,isWinner:i,round:this.state.round,gameIndex:this.gameSetup.gameIndex,roundIndex:this.state.round})}getRandomInt(e,t,n){const i=Math.floor(this.randomizer.random()*(t-e+1))+e;return i===n?this.getRandomInt(e,t,n):i}}t.RotationGame=m;m.id="Rotation";m.timeToWaitForOtherAnswer=2;m.instructions="Image is hidden and start rotating\n    Click the correct solution";function g(e,t,n){const i=new PlaneShape;i.withCollisions=0;i.uvs=n;const s=new Transform({scale:new Vector3(2,2,1e-6),position:new Vector3(0,2.7,0)});e.addComponent(i);e.addComponent(t);e.addComponent(s)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});const i=n(10),s=n(14),o=n(15),r=n(16),a=n(17),l=n(5),c=n(9),h=n(26),u=n(18),d=n(20),p=n(19),m=n(27),g=n(28);t.default={TransformSystem:l.TransformSystem,MoveTransformComponent:i.MoveTransformComponent,RotateTransformComponent:s.RotateTransformComponent,ScaleTransformComponent:o.ScaleTransformComponent,FollowPathComponent:r.FollowPathComponent,KeepRotatingComponent:a.KeepRotatingComponent,Interpolate:c.Interpolate,InterpolationType:c.InterpolationType,ToggleComponent:h.ToggleComponent,ToggleState:h.ToggleState,Delay:u.Delay,ExpireIn:d.ExpireIn,Interval:p.Interval,TriggerComponent:m.TriggerComponent,TriggerSystem:m.TriggerSystem,TriggerSphereShape:m.TriggerSphereShape,TriggerBoxShape:m.TriggerBoxShape,ActionsSequenceSystem:g.ActionsSequenceSystem}},function(e,t,n){var i=this&&this.__decorate||function(e,t,n,i){var s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i,r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},s;Object.defineProperty(t,"__esModule",{value:1});t.ToggleComponent=t.ToggleState=void 0;(function(e){e[e["Off"]=0]="Off";e[e["On"]=1]="On"})(s=t.ToggleState||(t.ToggleState={}));let o=class e{constructor(e=s.On,t){this.enabled=1;this.state=s.Off;this.set(e);t&&this.setCallback(t)}set(e){this.state=e;this.onValueChangedCallback&&this.onValueChangedCallback(e)}toggle(){this.enabled&&this.set(1-this.state)}isOn(){return this.state==s.On}setCallback(e){this.onValueChangedCallback=e}};o=i([Component("toggle")],o);t.ToggleComponent=o;t.default={ToggleComponent:o,ToggleState:s}},function(e,t,n){var i=this&&this.__decorate||function(e,t,n,i){var s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i,r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:1});t.TriggerSphereShape=t.TriggerBoxShape=t.TriggerComponent=t.TriggerSystem=void 0;class s{constructor(){this._triggers={};s._instance=this;this._cameraTriggerWrapper=new r(new l(new Vector3(.5,1.8,.5),new Vector3(0,.91,0)))}static get instance(){return this.createAndAddToEngine()}static createAndAddToEngine(){if(null==this._instance){this._instance=new s;engine.addSystem(this._instance)}return this._instance}setCameraTriggerShape(e){this._cameraTriggerWrapper.setShape(e)}update(){let e;engine.getComponentGroup(a).entities.forEach(e=>{this.shouldWrapTriggerEntity(e)&&this.wrapTriggerEntity(e)});for(const e in this._triggers)if(this._triggers.hasOwnProperty(e)){let t=this._triggers[e];t.isDebugging()&&t.updateDebugEntity();if(t.isInEngine()){if(null!=t.trigger&&t.trigger.enabled){t.wasEnabled||t.isDebugging()&&t.addDebugEntity();t.wasEnabled=1;(t.trigger.onCameraEnter||t.trigger.onCameraExit)&&this.checkCollisionAgainstCamera(t);(t.trigger.onTriggerEnter||t.trigger.onTriggerExit)&&this.checkCollisionAgainstOtherTriggers(t)}else if(t.wasEnabled){t.wasEnabled=0;t.isDebugging()&&t.removeDebugEntity();s.removeTriggerFromSystem(t)}}else{t.isDebugging()&&t.removeDebugEntity();s.removeTriggerFromSystem(t);delete this._triggers[e]}}}shouldWrapTriggerEntity(e){return null==this._triggers[e.uuid]||null==this._triggers[e.uuid]}wrapTriggerEntity(e){this._triggers[e.uuid]=new o(e)}static removeTriggerFromSystem(e){let t=e.getActiveCollisions();for(let n=0;n<t.length;n++){t[n].trigger.onTriggerExit&&e.entity&&t[n].trigger.onTriggerExit(e.entity);t[n].disengageActiveCollision(e);e.disengageActiveCollision(t[n])}}static disengageCollision(e,t){e.disengageActiveCollision(t);t.disengageActiveCollision(e);e.trigger.onTriggerExit&&t.entity&&e.trigger.onTriggerExit(t.entity);t.trigger.onTriggerExit&&e.entity&&t.trigger.onTriggerExit(e.entity)}static engageCollision(e,t){e.engageCollision(t);t.engageCollision(e);e.trigger.onTriggerEnter&&t.entity&&e.trigger.onTriggerEnter(t.entity);t.trigger.onTriggerEnter&&e.entity&&t.trigger.onTriggerEnter(e.entity)}checkCollisionAgainstCamera(e){let t=e.hasActiveCollision(this._cameraTriggerWrapper),n=s.areColliding(e,this._cameraTriggerWrapper);if(t&&!n){e.disengageActiveCollision(this._cameraTriggerWrapper);e.trigger.onCameraExit&&e.trigger.onCameraExit()}else if(!t&&n){e.engageCollision(this._cameraTriggerWrapper);e.trigger.onCameraEnter&&e.trigger.onCameraEnter()}}checkCollisionAgainstOtherTriggers(e){for(const t in this._triggers)if(this._triggers.hasOwnProperty(t)&&t!=e.uuid&&this._triggers[t].trigger.enabled&&s.canTriggersCollide(e,this._triggers[t])){let n=e.hasActiveCollision(this._triggers[t]),i=s.areColliding(e,this._triggers[t]);n&&!i?s.disengageCollision(e,this._triggers[t]):!n&&i&&s.engageCollision(e,this._triggers[t])}}static canTriggersCollide(e,t){return 0==e.trigger.triggeredByLayer?1:0!=(t.trigger.layer&e.trigger.triggeredByLayer)}static areColliding(e,t){return e.getShape()instanceof l&&t.getShape()instanceof l?s.areCollidingAABB(e.getGlobalPosition(),e.getShape(),t.getGlobalPosition(),t.getShape()):e.getShape()instanceof c&&t.getShape()instanceof c?s.areCollidingSphere(e.getGlobalPosition(),e.getShape(),t.getGlobalPosition(),t.getShape()):e.getShape()instanceof l&&t.getShape()instanceof c?s.areCollidingAABBSphere(e.getGlobalPosition(),e.getShape(),t.getGlobalPosition(),t.getShape()):e.getShape()instanceof c&&t.getShape()instanceof l?s.areCollidingAABBSphere(t.getGlobalPosition(),t.getShape(),e.getGlobalPosition(),e.getShape()):0}static areCollidingAABB(e,t,n,i){let o=s.getBoxShapeValues(e,t),r=s.getBoxShapeValues(n,i);return o.min.x<=r.max.x&&o.max.x>=r.min.x&&o.min.y<=r.max.y&&o.max.y>=r.min.y&&o.min.z<=r.max.z&&o.max.z>=r.min.z}static areCollidingSphere(e,t,n,i){let s;return Vector3.DistanceSquared(e.add(t.position),n.add(i.position))<t.radius*t.radius+i.radius*i.radius}static areCollidingAABBSphere(e,t,n,i){let o=s.getBoxShapeValues(e,t),r={center:n.add(i.position),radius:i.radius},a=0;r.center.x<o.min.x&&(a+=(o.min.x-r.center.x)*(o.min.x-r.center.x));r.center.x>o.max.x&&(a+=(r.center.x-o.max.x)*(r.center.x-o.max.x));r.center.y<o.min.y&&(a+=(o.min.y-r.center.y)*(o.min.y-r.center.y));r.center.y>o.max.y&&(a+=(r.center.y-o.max.y)*(r.center.y-o.max.y));r.center.z<o.min.z&&(a+=(o.min.z-r.center.z)*(o.min.z-r.center.z));r.center.z>o.max.z&&(a+=(r.center.z-o.max.z)*(r.center.z-o.max.z));return a<r.radius*r.radius}static getBoxShapeValues(e,t){let n=e.add(t.position);return{center:n,min:n.subtract(t.size.scale(.5)),max:n.add(t.size.scale(.5))}}}t.TriggerSystem=s;s._instance=null;class o{constructor(e){this.wasEnabled=1;this._uuid="";this._collidingWith={};this._isDebug=0;this._debugEntity=null;this._entity=e;if(e){this._trigger=e.getComponent(a);this._uuid=e.uuid;this._isDebug=this._trigger.debugEnabled;this._isDebug&&this.addDebugEntity()}}get entity(){return this._entity}get trigger(){return this._trigger}get uuid(){return this._uuid}getGlobalPosition(){return this._entity?o.getEntityWorldPosition(this._entity):Vector3.Zero()}getShape(){return this._trigger.shape}isInEngine(){return null!=this._entity&&this._entity.isAddedToEngine()}getActiveCollisions(){let e=[];for(const t in this._collidingWith)this._collidingWith.hasOwnProperty(t)&&e.push(this._collidingWith[t]);return e}hasActiveCollision(e){return null!=this._collidingWith[e.uuid]&&null!=this._collidingWith[e.uuid]}disengageActiveCollision(e){delete this._collidingWith[e.uuid]}engageCollision(e){this._collidingWith[e.uuid]=e}isDebugging(){return this._isDebug}addDebugEntity(){if(!o._debugMaterial){o._debugMaterial=new Material;o._debugMaterial.alphaTest=.5}if(null==this._debugEntity){this._debugEntity=new Entity;const e=new Transform;this._debugEntity.addComponent(e);this._debugEntity.addComponent(o._debugMaterial);if(this.getShape()instanceof l){const t=new BoxShape;t.withCollisions=0;this._debugEntity.addComponent(t);e.scale=this.getShape().size}if(this.getShape()instanceof c){const t=new SphereShape;t.withCollisions=0;this._debugEntity.addComponent(t);let n=this.getShape().radius;e.scale=new Vector3(n,n,n)}}engine.addEntity(this._debugEntity)}removeDebugEntity(){null!=this._debugEntity&&engine.removeEntity(this._debugEntity)}updateDebugEntity(){this._debugEntity&&(this._debugEntity.getComponent(Transform).position=this.getGlobalPosition().add(this.getShape().position))}static getEntityWorldPosition(e){let t=e.hasComponent(Transform)?e.getComponent(Transform).position:Vector3.Zero(),n=e.getParent();if(null!=n){let e=n.hasComponent(Transform)?n.getComponent(Transform).rotation:Quaternion.Identity;return this.getEntityWorldPosition(n).add(t.rotate(e))}return t}}o._debugMaterial=null;class r extends o{constructor(e){super();this._shape=e;this._uuid="cameraTrigger"}getGlobalPosition(){return Camera.instance.position}getShape(){return this._shape}setShape(e){this._shape=e}isInEngine(){return 0}hasActiveCollision(e){return 0}disengageActiveCollision(e){}engageCollision(e){}isDebugging(){return 0}}let a=class e{constructor(e,t=0,n=0,i,o,r,a,l=0){this.enabled=1;this.layer=0;this.triggeredByLayer=0;s.createAndAddToEngine();this.shape=e;this.layer=t;this.triggeredByLayer=n;this.onTriggerEnter=i;this.onTriggerExit=o;this.onCameraEnter=r;this.onCameraExit=a;this._debugEnabled=l}get debugEnabled(){return this._debugEnabled}};a=i([Component("triggerComponent")],a);t.TriggerComponent=a;class l{constructor(e,t){this.size=e;this.position=t}}t.TriggerBoxShape=l;class c{constructor(e,t){this.radius=e;this.position=t}}t.TriggerSphereShape=c},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.ActionsSequenceSystem=void 0;class i{constructor(e){this.beginSequenceNode=null;this.currentSequenceNode=null;this.running=0;this.started=0;e&&this.startSequence(e)}startSequence(e){this.beginSequenceNode=e.beginSequenceNode;this.currentSequenceNode=this.beginSequenceNode;this.running=1;this.started=0}setOnFinishCallback(e){this.onFinishCallback=e}isRunning(){return this.running}stop(){this.running=0}resume(){null!=this.beginSequenceNode&&(this.running=1)}reset(){this.currentSequenceNode=this.beginSequenceNode;this.running=1;this.started=0}getRunningAction(){let e=this.currentSequenceNode;if(this.currentSequenceNode instanceof o)do{e=e.currentInnerSequence}while(e instanceof o);return e.action}update(e){if(this.running)if(this.started)if(this.currentSequenceNode.hasFinish()){this.currentSequenceNode.onFinish();this.currentSequenceNode=this.currentSequenceNode.next;if(this.currentSequenceNode)this.currentSequenceNode.onStart();else{this.running=0;this.onFinishCallback&&this.onFinishCallback()}}else this.currentSequenceNode.update(e);else{this.currentSequenceNode.onStart();this.started=1}}}t.ActionsSequenceSystem=i;(function(e){class t{constructor(){this.currentSequenceNode=null;this.beginSequenceNode=null;this.whileNodeStack=[]}then(e){if(null==this.currentSequenceNode){this.currentSequenceNode=new s;this.currentSequenceNode.action=e;this.beginSequenceNode=this.currentSequenceNode}else{let t=new s;t.action=e;this.currentSequenceNode=this.currentSequenceNode.then(t)}return this}if(e){let t=new r(e);if(null==this.currentSequenceNode){this.currentSequenceNode=t;this.beginSequenceNode=t}else this.currentSequenceNode=this.currentSequenceNode.then(t);return this}else(){let e=this.currentSequenceNode.getSequence();if(!(e instanceof r))throw new Error("IF statement is needed to be called before ELSE statement.");{e.closed=1;let t=new a(e);this.currentSequenceNode=this.currentSequenceNode.then(t)}return this}endIf(){let e=this.currentSequenceNode.getSequence();if(!(e instanceof r||e instanceof a))throw new Error("IF statement is needed to be called before ENDIF statement.");e.closed=1;return this}while(e){let t=new l(e);if(null==this.currentSequenceNode){this.currentSequenceNode=t;this.beginSequenceNode=t}else this.currentSequenceNode=this.currentSequenceNode.then(t);this.whileNodeStack.push(t);return this}endWhile(){let e=this.currentSequenceNode.getSequence();if(!(e instanceof l))throw new Error("WHILE statement is needed to be called before ENDWHILE statement.");e.closed=1;this.whileNodeStack.length>0&&this.whileNodeStack.splice(this.whileNodeStack.length-1,1);return this}breakWhile(){if(!(this.whileNodeStack.length>0))throw new Error("WHILE statement is needed to be called before BREAKWHILE statement.");this.currentSequenceNode=this.currentSequenceNode.then(new c(this.whileNodeStack[this.whileNodeStack.length-1]));return this}}e.SequenceBuilder=t})(i=t.ActionsSequenceSystem||(t.ActionsSequenceSystem={}));class s{constructor(){this.action=null;this.next=null}then(e){this.next=e;return e}onStart(){this.action&&this.action.onStart()}update(e){this.action&&this.action.update(e)}onFinish(){this.action&&this.action.onFinish()}hasFinish(){return this.action?this.action.hasFinished:1}getSequence(){return this}}class o extends s{constructor(){super(...arguments);this.currentInnerSequence=null;this.startingInnerSequence=null;this.closed=0}then(e){if(null==this.currentInnerSequence){this.currentInnerSequence=e;this.startingInnerSequence=e}else{if(this.closed){this.next=e;return e}this.currentInnerSequence=this.currentInnerSequence.then(e)}return this}onStart(){this.currentInnerSequence=this.startingInnerSequence;this.currentInnerSequence&&this.currentInnerSequence.onStart()}update(e){if(this.currentInnerSequence)if(this.currentInnerSequence.hasFinish()){this.currentInnerSequence.onFinish();this.currentInnerSequence=this.currentInnerSequence.next;this.currentInnerSequence&&this.currentInnerSequence.onStart()}else this.currentInnerSequence.update(e)}onFinish(){this.currentInnerSequence&&this.currentInnerSequence.onFinish()}hasFinish(){return null==this.currentInnerSequence}getSequence(){if(this.currentInnerSequence){let e=this.currentInnerSequence.getSequence();if(e instanceof o&&!e.closed)return e}return this}}class r extends o{constructor(e){super();this.result=0;this.condition=e}onStart(){this.result=this.condition();this.result?super.onStart():this.currentInnerSequence=null}}class a extends o{constructor(e){super();this.ifSequence=null;this.ifSequence=e}onStart(){this.ifSequence&&!this.ifSequence.result?super.onStart():this.currentInnerSequence=null}}class l extends o{constructor(e){super();this.breakWhile=0;this.condition=e}onStart(){this.breakWhile=0;this.condition()?super.onStart():this.currentInnerSequence=null}update(e){if(this.currentInnerSequence)if(this.currentInnerSequence.hasFinish()){this.currentInnerSequence.onFinish();this.currentInnerSequence=this.currentInnerSequence.next;null==this.currentInnerSequence&&(this.currentInnerSequence=this.startingInnerSequence);this.currentInnerSequence&&this.currentInnerSequence.onStart()}else this.currentInnerSequence.update(e)}hasFinish(){return this.breakWhile||!this.condition()}}class c extends s{constructor(e){super();this.whileNode=e}onStart(){this.whileNode.breakWhile=1}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.AttackGame=void 0;const i=n(12),s=n(3),o=n(6),r=n(1),a=n(7),l=n(2),c=n(0),h=n(4),u={DEFEND:0,ATTACK:1},d=640/71*16,p=11;let m=0;const g={E:1,F:2,CLICK:3};class S{constructor(e,{currentPlayer:t,seed:n,level:o,gameIndex:a}){this.state={startTime:Number.MAX_VALUE,roundStartTime:Number.MAX_VALUE,lastRoundStartTime:Number.MAX_VALUE,waitingRound:0,initialized:0,round:0,idle:1,started:0,blocked:0,finished:0,player1Key:-1,player2Key:-2};this.callbacks={onFinish:null,onFinishRound:null,onShareState:null};this.score1=0;this.score2=0;void 0;m++;this.id=m;const l=engine.getEntitiesWithComponent("game_scene");void 0;Object.keys(l).forEach(e=>{engine.removeEntity(l[e])});this.root=e;this.gameSetup={currentPlayer:t,seed:n,level:o,gameIndex:a};this.randomizer=s.seedGen.create(n.toString());this.scene=new Entity;this.scene.addComponent(new i.GameScene);this.scene.addComponent(new Transform({position:new Vector3(0,0,-.002)}));this.ui=h.createUI(this.scene);this.label1=c.createSpriteEntity(this.scene,{position:new Vector3(-1.5,3.5,-.001),uvs:c.getSpriteUv(4,384,32,32),scale:new Vector3(1,1,1)});this.label2=c.createSpriteEntity(this.scene,{position:new Vector3(1.5,3.5,-.001),uvs:c.getSpriteUv(4,384,32,32),scale:new Vector3(1,1,1)});this.label1.hide();this.label2.hide();this.char1=new Entity;this.char2=new Entity;this.char1.addComponent(r.spriteMaterial);this.char2.addComponent(r.spriteMaterial);this.char1.addComponent(new Transform({position:new Vector3(-1,2,0),scale:new Vector3(2,2,1)}));this.char2.addComponent(new Transform({position:new Vector3(1,2,0),scale:new Vector3(-2,2,1)}));this.char1.setParent(this.scene);this.char2.setParent(this.scene);this.char1Shape=new PlaneShape;this.char1Shape.uvs=c.getSpriteUv(1,d,64,71);this.char2Shape=new PlaneShape;this.char2Shape.uvs=c.getSpriteUv(1,d,64,71);this.char1.addComponent(this.char1Shape);this.char2.addComponent(this.char2Shape);this.roundResult1=h.createRoundResult(this.scene,{player:1});this.roundResult2=h.createRoundResult(this.scene,{player:2});this.roundResult1.hide();this.roundResult2.hide();this.state=Object.assign(Object.assign({},this.state),{player1Key:1+Math.floor(3*this.randomizer.random()),player2Key:1+Math.floor(3*this.randomizer.random()),started:0});engine.addSystem(this)}setStartTime(e){void 0;this.state.startTime=e}reset(){}setRoundStartTime(e){void 0;this.state.roundStartTime=e}finishRound({winner:e}){this.label1.hide();this.label2.hide();l.stopSound("swing");l.playOnce("hit");this["score"+e]+=1;this.ui.updateScore({player:e,score:this["score"+e]});e!==this.gameSetup.currentPlayer?setTimeout(()=>{l.playOnce("fail")},500):setTimeout(()=>{l.playOnce("ok")},500);Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.PRIMARY,this.primaryButtonCallback);Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.SECONDARY,this.secondaryButtonCallback);Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.POINTER,this.clickButtonCallback);void 0;const t=[3,640/71*8,128,71];if(1===e){this.char2Shape.visible=0;const e=this.char1.getComponent(Transform);e.scale.set(4,2,1);e.position.set(0,2,0);this.char1Shape.uvs=c.getSpriteUv(...t)}else{this.char2Shape.visible=0;const e=this.char1.getComponent(Transform);e.scale.set(-4,2,1);e.position.set(0,2,0);this.char1Shape.uvs=c.getSpriteUv(...t)}const n=1===e?2:1;this["roundResult"+e].update(1);this["roundResult"+n].update(0);this.roundResult1.show();this.roundResult2.show();this.state.waitingRound=1}handleAction(e){Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.PRIMARY,this.primaryButtonCallback);Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.SECONDARY,this.secondaryButtonCallback);Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.POINTER,this.clickButtonCallback);this[`char${this.gameSetup.currentPlayer}Shape`].uvs=c.getSpriteUv(3,d,64,71);const t=o.getTimeSinceStart(0===this.state.round?this.state.startTime:this.state.lastRoundStartTime);void 0;const n=e?t:999999999-t;this.ui.updateTime({player:this.gameSetup.currentPlayer,time:t});this.callbacks.onShareState({player:this.gameSetup.currentPlayer,time:n,timeSinceStart:t,round:this.state.round});if(this.state.round<p-1){this.callbacks.onFinishRound({player:this.gameSetup.currentPlayer,time:n,isWinner:e,gameIndex:this.gameSetup.gameIndex,roundIndex:this.state.round});this.state.waitingRound=1}else this.callbacks.onFinish({player:this.gameSetup.currentPlayer,time:n,isWinner:e,gameIndex:this.gameSetup.gameIndex})}clickButtonCallback(e){l.playOnce("swing");const t=this.state[`player${this.gameSetup.currentPlayer}Key`]===g.CLICK;this.handleAction(t)}primaryButtonCallback(e){l.playOnce("swing");const t=this.state[`player${this.gameSetup.currentPlayer}Key`]===g.E;this.handleAction(t)}secondaryButtonCallback(e){l.playOnce("swing");const t=this.state[`player${this.gameSetup.currentPlayer}Key`]===g.F;this.handleAction(t)}init(){a.updateSpritePanel({uvs:c.getSpriteUv(4,0,192,128)});a.showSpritePanel();l.playLoop("battle",{volume:.5});void 0;this.scene.setParent(this.root);this.state.initialized=1}start(){void 0;this.state.round=0;this.state.idle=0;this.state.finished=0;this.state.started=1;this.primaryButtonCallback=this.primaryButtonCallback.bind(this);this.secondaryButtonCallback=this.secondaryButtonCallback.bind(this);this.clickButtonCallback=this.clickButtonCallback.bind(this);this.gameSetup.currentPlayer&&Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,0,this.primaryButtonCallback);this.gameSetup.currentPlayer&&Input.instance.subscribe("BUTTON_DOWN",ActionButton.SECONDARY,0,this.secondaryButtonCallback);this.gameSetup.currentPlayer&&Input.instance.subscribe("BUTTON_DOWN",ActionButton.POINTER,0,this.clickButtonCallback);this.label1.show();this.label2.show();this.label1.updateUvs(c.getSpriteUv(this.state.player1Key,387,32,32));this.label2.updateUvs(c.getSpriteUv(this.state.player2Key,387,32,32))}startRound(){this.state.round++;this.ui.hideTime();this.char2Shape.visible=1;const e=this.char1.getComponent(Transform);e.scale.set(2,2,1);e.position.set(-1,2,0);this.char1Shape.uvs=c.getSpriteUv(1,d,64,71);this.char2Shape.uvs=c.getSpriteUv(1,d,64,71);this.roundResult1.hide();this.roundResult2.hide();this.state.lastRoundStartTime=this.state.roundStartTime;this.state.roundStartTime=Number.MAX_VALUE;void 0;this.state.idle=0;this.state.started=1;this.state.waitingRound=0;Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,0,this.primaryButtonCallback);Input.instance.subscribe("BUTTON_DOWN",ActionButton.SECONDARY,0,this.secondaryButtonCallback);Input.instance.subscribe("BUTTON_DOWN",ActionButton.POINTER,0,this.clickButtonCallback);this.state=Object.assign(Object.assign({},this.state),{player1Key:1+Math.floor(3*this.randomizer.random()),player2Key:1+Math.floor(3*this.randomizer.random())});this.label1.show();this.label2.show();this.label1.updateUvs(c.getSpriteUv(this.state.player1Key,387,32,32));this.label2.updateUvs(c.getSpriteUv(this.state.player2Key,387,32,32))}destroy(){l.stopAllSounds();a.hideSpritePanel();Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.PRIMARY,this.primaryButtonCallback);Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.SECONDARY,this.secondaryButtonCallback);Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.POINTER,this.clickButtonCallback);void 0;const e=engine.getEntitiesWithComponent("game_scene");void 0;Object.keys(e).forEach(e=>{});this.scene.setParent(null);engine.removeEntity(this.scene);void 0;engine.removeSystem(this)}finish(e){this.label1.hide();this.label2.hide();const{winner:t}=e;void 0;const n=1===t?2:1;l.stopSound("swing");l.playOnce("hit");t!==this.gameSetup.currentPlayer?l.playOnce("fail"):l.playOnce("ok");const i=[3,640/71*8,128,71];if(1===t){this.char2Shape.visible=0;const e=this.char1.getComponent(Transform);e.scale.set(4,2,1);e.position.set(0,2,0);this.char1Shape.uvs=c.getSpriteUv(...i)}else{this.char2Shape.visible=0;const e=this.char1.getComponent(Transform);e.scale.set(-4,2,1);e.position.set(0,2,0);this.char1Shape.uvs=c.getSpriteUv(...i)}this.roundResult1.show();this.roundResult2.show();this["roundResult"+t].update(1);this["roundResult"+n].update(0)}block(){this.state.blocked=1;Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.PRIMARY,this.primaryButtonCallback);Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.SECONDARY,this.secondaryButtonCallback);Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.POINTER,this.clickButtonCallback)}onFinish(e){this.callbacks.onFinish=e;return()=>{this.callbacks.onFinish=null}}onFinishRound(e){this.callbacks.onFinishRound=e;return()=>this.callbacks.onFinishRound=null}shareState(e){void 0;const{player:t,timeSinceStart:n,time:i,round:s}=e;if(s===this.state.round){this[`char${t}Shape`].uvs=c.getSpriteUv(3,d,64,71);this.ui.updateTime({player:t,time:n})}}onShareState(e){this.callbacks.onShareState=e;return()=>this.callbacks.onShareState=null}update(e){if(this.state.initialized)if(!this.state.waitingRound&&!this.state.started&&Date.now()>=this.state.startTime){void 0;this.start()}else if(this.state.started&&this.state.waitingRound&&Date.now()>=this.state.roundStartTime){void 0;this.startRound()}else Date.now()>=this.state.roundStartTime}}t.AttackGame=S;S.id="Attack";S.timeToWaitForOtherAnswer=1;S.instructions="2 old warriors on each player side, \n    faster than your opponent,\n    press the appropriate key: E, F or CLICK"},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.CostumeGame=void 0;const i=n(3),s=n(12),o=n(31),r=n(36),a=n(37),l=n(6),c=n(7),h=n(2),u=n(4),d=n(0),p=3;class m{constructor(e,{seed:t,currentPlayer:n,level:l,gameIndex:c}){this.state={startTime:Number.MAX_VALUE,roundStartTime:Number.MAX_VALUE,lastRoundStartTime:Number.MAX_VALUE,waitingRound:0,round:0,score1:0,score2:0,started:0,finished:0,blocked:0,idle:1};this.entity={};this.completion={hair:0,glasses:0,shirt:0,pants:0};this.callbacks={onFinish:null,onShareState:null,onFinishRound:null};this.root=e;this.gameSetup={currentPlayer:n,seed:t,level:l,gameIndex:c};this.randomizer=i.seedGen.create(t.toString());this.scene=new Entity;this.scene.addComponent(new s.GameScene);this.scene.addComponent(new Transform({position:new Vector3(0,0,-.002)}));this.ui=u.createUI(this.scene);const h=this.modelDefinition={hair:this.getRandomInt(1,10),shirt:this.getRandomInt(1,5),pants:this.getRandomInt(1,5),glasses:this.getRandomInt(1,5)},d=-.05;this.entity.model=o.createModel(this.scene,{modelDefinition:h,position:new Vector3(0+d,2,0),scale:new Vector3(1.5,1.5,1),showLabel:"model"});this.dollModel1=o.createModel(this.scene,{modelDefinition:{hair:0,shirt:0,pants:0,glasses:0},position:new Vector3(-1.5+d,2,0),scale:new Vector3(1.5,1.5,1)});this.dollModel2=o.createModel(this.scene,{modelDefinition:{hair:0,shirt:0,pants:0,glasses:0},position:new Vector3(1.5+d,2,0),scale:new Vector3(1.5,1.5,1)});this.collection=r.createCollection(this.getRandomInt.bind(this),h);void 0;void 0;this.collection.forEach(e=>{if(!e)debugger});try{void 0;n&&(this.collectionControl=a.createCollectionControl(this.scene,{collection:this.collection,side:n}))}catch(e){debugger}this.roundResult1=u.createRoundResult(this.scene,{player:1});this.roundResult2=u.createRoundResult(this.scene,{player:2});this.roundResult1.hide();this.roundResult2.hide();this.primaryButtonCallback=this.primaryButtonCallback.bind(this);this.secondaryButtonCallback=this.secondaryButtonCallback.bind(this);this.clickCallback=this.clickCallback.bind(this);engine.addSystem(this)}setStartTime(e){this.state.startTime=e}init(){h.playLoop("money",{volume:.5});c.updateSpritePanel({uvs:d.getSpriteUv(5,0,192,128)});c.showSpritePanel();this.state.initialized=1}start(){this.scene.setParent(this.root);this.state.started=1;if(this.gameSetup.currentPlayer){Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,0,this.primaryButtonCallback);Input.instance.subscribe("BUTTON_DOWN",ActionButton.SECONDARY,0,this.secondaryButtonCallback);Input.instance.subscribe("BUTTON_DOWN",ActionButton.POINTER,0,this.clickCallback)}}startRound(){this.state.round++;void 0;this.roundResult1.hide();this.roundResult2.hide();this.ui.hideTime();this.state.blocked=0;this.state.lastRoundStartTime=this.state.roundStartTime;this.state.roundStartTime=Number.MAX_VALUE;this.state.waitingRound=0;const e=this.modelDefinition={hair:this.getRandomInt(1,10),shirt:this.getRandomInt(1,5),pants:this.getRandomInt(1,5),glasses:this.getRandomInt(1,5)};Object.keys(e).forEach(t=>{this.entity.model.update({type:t,index:e[t]});this.dollModel1.update({type:t,index:0});this.dollModel2.update({type:t,index:0});this.completion[t]=0});this.collection=r.createCollection(this.getRandomInt.bind(this),e);this.gameSetup.currentPlayer&&(this.collectionControl=a.createCollectionControl(this.scene,{collection:this.collection,side:this.gameSetup.currentPlayer}))}block(){this.state.blocked=1}finish({winner:e}){void 0;const t=1===e?2:1;this.roundResult1.show();this.roundResult2.show();this["roundResult"+e].update(1);this["roundResult"+t].update(0)}finishRound({winner:e}){void 0;this.state.blocked=1;this.state["score"+e]+=1;this.ui.updateScore({player:e,score:this.state["score"+e]});e===this.gameSetup.currentPlayer?h.playOnce("wow"):h.playOnce("fail");this.state.waitingRound=1;this.collectionControl&&this.collectionControl.dispose();Object.keys(this.modelDefinition).forEach(e=>{this.entity.model.update({type:e,index:0})});const t=1===e?2:1;this.roundResult1.show();this.roundResult2.show();this["roundResult"+e].update(1);this["roundResult"+t].update(0)}onFinish(e){this.callbacks.onFinish=e;return()=>this.callbacks.onFinish=null}onFinishRound(e){this.callbacks.onFinishRound=e;return()=>this.callbacks.onFinishRound=null}onShareState(e){this.callbacks.onShareState=e;return()=>this.callbacks.onShareState=null}setRoundStartTime(e){this.state.roundStartTime=e}shareState({player:e,completion:t,timeSinceStart:n}){Object.keys(t).forEach(n=>{t[n]&&this["dollModel"+e].update({type:n,index:this.modelDefinition[n]})});n&&this.ui.updateTime({player:e,time:n})}clickCallback(){if(this.state.blocked)return;void 0;const e=this.collectionControl.getCurrent();if(!e)debugger;if(this.modelDefinition[e.type]===e.index){void 0;h.playOnce("ok");this["dollModel"+this.gameSetup.currentPlayer].update(e);this.completion[e.type]=1;if(Object.values(this.completion).every(e=>e)){void 0;const e=l.getTimeSinceStart(0===this.state.round?this.state.startTime:this.state.lastRoundStartTime);this.ui.updateTime({player:this.gameSetup.currentPlayer,time:e});this.callbacks.onShareState({player:this.gameSetup.currentPlayer,completion:this.completion,timeSinceStart:e});this.state.round<p-1?this.callbacks.onFinishRound({time:e,player:this.gameSetup.currentPlayer,gameIndex:this.gameSetup.gameIndex,roundIndex:this.state.round}):this.callbacks.onFinish({time:e,isWinner:this.gameSetup.currentPlayer,gameIndex:this.gameSetup.gameIndex,roundIndex:this.state.round})}else this.callbacks.onShareState({player:this.gameSetup.currentPlayer,completion:this.completion})}else{void 0;h.playOnce("fail");this.state.blocked=1;this.collectionControl.showError();setTimeout(()=>{this.collectionControl.hideError();this.state.blocked=0},500)}}primaryButtonCallback(){this.state.blocked||this.collectionControl.previous()}secondaryButtonCallback(){this.state.blocked||this.collectionControl.next()}destroy(){h.stopSound("money");c.hideSpritePanel();this.scene.setParent(null);engine.removeEntity(this.scene);engine.removeSystem(this);Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.PRIMARY,this.primaryButtonCallback);Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.SECONDARY,this.secondaryButtonCallback);Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.POINTER,this.clickCallback)}update(e){if(this.state.initialized){!this.state.waitingRound&&!this.state.started&&Date.now()>=this.state.startTime&&this.start();this.state.started&&this.state.waitingRound&&Date.now()>=this.state.roundStartTime&&this.startRound()}}getRandomInt(e,t,n){const i=e+Math.floor(this.randomizer.random()*(t-e+1));return i===n?this.getRandomInt(e,t,n):i}}t.CostumeGame=m;m.id="Costume";m.instructions="You have to complete the costume\n    before your opponent\n    E,F to roll parts\n    CLICK to select"},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.createModel=void 0;const i=n(32),s=n(33),o=n(34),r=n(35),a=n(1),l=n(0);t.createModel=(e,{modelDefinition:t,position:n,scale:c,showLabel:h=""})=>{const u=new Entity;u.addComponent(new Transform({position:n,scale:c}));const d=new Entity,p=new PlaneShape;p.withCollisions=0;p.isPointerBlocker=0;p.uvs=l.getSpriteUv(16,112,64,128);const m=undefined;(new Material).albedoColor=new Color3(1,0,0);const g=new Transform({scale:new Vector3(-1,2,-1),position:new Vector3(0,0,0)});g.rotation.setEuler(0,180,0);d.addComponent(g);d.addComponent(a.spriteMaterial);d.addComponent(p);d.setParent(u);u.setParent(e);const S={glasses:null,hair:null,shirt:null,pants:null};S.glasses=s.createGlasses(u,{partDefinition:{type:"glasses",index:t.glasses}});S.hair=i.createHair(u,{partDefinition:{type:"hair",index:t.hair}});S.pants=r.createPants(u,{partDefinition:{type:"pants",index:t.pants}});S.shirt=o.createShirt(u,{partDefinition:{type:"shirt",index:t.shirt}});if(h){const e=new Entity;e.setParent(u);const t=new TextShape("model");t.fontSize=2;t.font=new Font(Fonts.SanFrancisco_Heavy);e.addComponent(t);e.addComponent(new Transform({position:new Vector3(0,1.3,0)}))}const y=({partDefinition:e})=>{};return{entity:u,update:e=>{if(!e)debugger;S[e.type].updateIndex(e.index)},dispose:()=>{}}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.createHair=void 0;const i=n(8),s=n(1),o=n(0);t.createHair=(e,{partDefinition:t})=>{const n=4/128/2,r=new Entity,a=new PlaneShape;a.withCollisions=0;const l=new Transform({position:new Vector3(.25-15*n,.375+23*n,-3e-4),scale:new Vector3(1,1,1)});r.addComponent(a);r.addComponent(l);r.addComponent(s.spriteMaterial);r.setParent(e);a.uvs=o.getSpriteUv(t.index,i.PART_OFFSET_INDEX["hair"],i.PART_SIZE_WIDTH["hair"]);return{dispose:()=>{e.setParent(null);engine.removeEntity(r)},updateIndex:e=>{a.uvs=o.getSpriteUv(e,i.PART_OFFSET_INDEX["hair"],i.PART_SIZE_WIDTH["hair"])}}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.createGlasses=void 0;const i=n(8),s=n(1),o=n(0);t.createGlasses=(e,{partDefinition:t})=>{const n=4/128/2,r=new Entity,a=new PlaneShape;a.withCollisions=0;const l=new Transform({position:new Vector3(.25-15*n,.375+8*n,-5e-4),scale:new Vector3(1,1,1)});r.addComponent(a);r.addComponent(l);r.addComponent(s.spriteMaterial);r.setParent(e);a.uvs=o.getSpriteUv(t.index,i.PART_OFFSET_INDEX["glasses"],i.PART_SIZE_WIDTH["glasses"],i.PART_SIZE_HEIGHT["glasses"]);return{dispose:()=>{e.setParent(null);engine.removeEntity(r)},updateIndex:e=>{a.uvs=o.getSpriteUv(e,i.PART_OFFSET_INDEX["glasses"],i.PART_SIZE_WIDTH["glasses"],i.PART_SIZE_HEIGHT["glasses"])}}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.createShirt=void 0;const i=n(8),s=n(1),o=n(0);t.createShirt=(e,{partDefinition:t})=>{const n=4/128/2,r=new Entity,a=new PlaneShape;a.withCollisions=0;const l=new Transform({position:new Vector3(4*n,.5-15*n,-.002),scale:new Vector3(1,1,1)});r.addComponent(a);r.addComponent(l);r.addComponent(s.spriteMaterial);r.setParent(e);a.uvs=o.getSpriteUv(t.index,i.PART_OFFSET_INDEX["shirt"],i.PART_SIZE_WIDTH["shirt"]);return{dispose:()=>{e.setParent(null);engine.removeEntity(r)},updateIndex:e=>{a.uvs=o.getSpriteUv(e,i.PART_OFFSET_INDEX["shirt"],i.PART_SIZE_WIDTH["shirt"])}}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.createPants=void 0;const i=n(8),s=n(1),o=n(0);t.createPants=(e,{partDefinition:t})=>{const n=4/128/2,r=new Entity,a=new PlaneShape;a.withCollisions=0;const l=new Transform({position:new Vector3(5*n,2*n-.5,-.001),scale:new Vector3(1,1,1)});r.addComponent(a);r.addComponent(l);r.addComponent(s.spriteMaterial);r.setParent(e);a.uvs=o.getSpriteUv(t.index,i.PART_OFFSET_INDEX["pants"],i.PART_SIZE_WIDTH["pants"]);return{dispose:()=>{e.setParent(null);engine.removeEntity(r)},updateIndex:e=>{a.uvs=o.getSpriteUv(e,i.PART_OFFSET_INDEX["pants"],i.PART_SIZE_WIDTH["pants"])}}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.createCollection=t.MAX_INDEX=void 0;t.MAX_INDEX={hair:10,glasses:5,shirt:5,pants:5};const i=["hair","glasses","shirt","pants"];t.createCollection=(e,n)=>{void 0;const s=Object.keys(n).map(e=>({type:e,index:n[e]})),o=[...s];i.forEach(n=>{let i=3;for(;i--;){let i=e(1,t.MAX_INDEX[n]);const r=s.find(e=>e.type===n);for(;i===r.index||o.find(e=>e.type===n&&e.index===i);)i=e(1,t.MAX_INDEX[n]);o.push({type:n,index:i})}});return r(o);function r(t){for(var n=t.length,i,s;0!==n;){s=Math.floor(e(1,100)/100*n);i=t[n-=1];t[n]=t[s];t[s]=i}return t}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.createCollectionControl=void 0;const i=n(8),s=n(21),o=n(1),r=n(0),a=n(2),l=.7,c=0,h=-.7;t.createCollectionControl=(e,{collection:t,side:n,avoidAdd:u=0})=>{const d=new Entity,p=new Entity,m=new Entity,g=new Entity,S=new Entity,y=new TextShape("E");y.fontSize=2;S.addComponent(y);S.addComponent(new Transform({position:new Vector3(1===n?-.3:.3,.8,-.002)}));S.setParent(d);const f=new Entity,T=new TextShape("F");T.fontSize=2;f.addComponent(T);f.addComponent(new Transform({position:new Vector3(1===n?-.3:.3,-.75,-.002)}));f.setParent(d);p.setParent(d);m.setParent(d);g.setParent(d);const b=t[0],w=t[1],v=t[2];let C=1;const P=new PlaneShape,R=new PlaneShape,E=new PlaneShape,_=new Vector3(.5,.5,.5);p.addComponent(new Transform({position:new Vector3(0,l,0),scale:_}));g.addComponent(new Transform({position:new Vector3(0,c,0),scale:new Vector3(1,1,1)}));m.addComponent(new Transform({position:new Vector3(0,h,0),scale:_}));p.addComponent(P);g.addComponent(E);m.addComponent(R);if(!b||!w||!v)debugger;P.uvs=r.getSpriteUv(b.index,i.PART_OFFSET_INDEX[b.type],i.PART_SIZE_WIDTH[b.type],i.PART_SIZE_HEIGHT[b.type]);E.uvs=r.getSpriteUv(w.index,i.PART_OFFSET_INDEX[w.type],i.PART_SIZE_WIDTH[w.type],i.PART_SIZE_HEIGHT[w.type]);R.uvs=r.getSpriteUv(v.index,i.PART_OFFSET_INDEX[v.type],i.PART_SIZE_WIDTH[v.type],i.PART_SIZE_HEIGHT[v.type]);p.addComponent(o.spriteMaterial);g.addComponent(o.spriteMaterial);m.addComponent(o.spriteMaterial);d.addComponent(new Transform({position:new Vector3(1===n?-2.5:2.5,2,-.001)}));u||d.setParent(e);const I=s.createCross(d,{position:new Vector3(0,0,-.003),scale:_});I.hide();x(C);return{entity:d,hide:()=>{d.setParent(null);engine.removeEntity(d)},show:()=>{d.setParent(e)},dispose:()=>{d.setParent(null);engine.removeEntity(d);d.children},getCurrent:()=>t[C],next:()=>{a.playOnce("swing");C=O(C);x(C)},previous:()=>{a.playOnce("swing");C=A(C);x(C)},showError:()=>{I.show()},hideError:()=>{I.hide()}};function A(e){return e-1<0?t.length-1:e-1}function O(e){return e+1>t.length-1?0:e+1}function x(e){const n=A(e),s=O(e),o=t[n],a=t[e],u=t[s],d=g.getComponent(Transform),S=d.position;if(!o||!a||!u)debugger;S.set(S.x,c-i.PART_TYPE_OFFSET_Y[a.type]*d.scale.y,S.z);const y=p.getComponent(Transform),f=y.position;f.set(f.x,l-i.PART_TYPE_OFFSET_Y[o.type]*y.scale.y,f.z);const T=m.getComponent(Transform),b=T.position;b.set(b.x,h-i.PART_TYPE_OFFSET_Y[u.type]*T.scale.y,b.z);P.uvs=r.getSpriteUv(o.index,i.PART_OFFSET_INDEX[o.type],i.PART_SIZE_WIDTH[o.type],i.PART_SIZE_HEIGHT[o.type]);E.uvs=r.getSpriteUv(a.index,i.PART_OFFSET_INDEX[a.type],i.PART_SIZE_WIDTH[a.type],i.PART_SIZE_HEIGHT[a.type]);R.uvs=r.getSpriteUv(u.index,i.PART_OFFSET_INDEX[u.type],i.PART_SIZE_WIDTH[u.type],i.PART_SIZE_HEIGHT[u.type])}}},function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function r(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i["throw"](e))}catch(e){o(e)}}function l(e){e.done?n(e.value):s(e.value).then(r,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:1});t.ObstacleGame=void 0;const s=n(3),o=n(39),r=n(2),a=n(13),l=n(4),c=({getRandomInt:e,level:t})=>{const n=80*Math.log(t+1);let i=n,s=[];const o=2,r=8;let a=1;for(;s.length<n;){s.push(...new Array(e(o,r)+(a?4:0)).fill(0),1);a=0}s.push(...new Array(3).fill(0));return s};class h{constructor(e,{seed:t,currentPlayer:n,level:i=1,gameIndex:r}){this.state={initialized:0,started:0,currentLeg:1,blocked:1,startTime:Number.MAX_VALUE};this.callbacks={onFinish:null,onShareState:null};this.root=e;this.scene=new Entity;this.scene.addComponent(new Transform({position:new Vector3(0,0,-.001)}));this.ui=l.createUI(this.scene);this.gameSetup={seed:t.toString(),currentPlayer:n,level:i,gameIndex:r};this.randomizer=s.seedGen.create(t.toString());const a=1===n?2:1,h=c({getRandomInt:this.getRandomInt.bind(this),level:i});void 0;this.screen1=o.createScreen(this.scene,{player:1,track:h});this.screen2=o.createScreen(this.scene,{player:2,track:h});this.roundResult1=l.createRoundResult(this.scene,{player:1});this.roundResult2=l.createRoundResult(this.scene,{player:2});this.roundResult1.hide();this.roundResult2.hide();this.moveLeg1=this.moveLeg1.bind(this);this.moveLeg2=this.moveLeg2.bind(this);this.jump=this.jump.bind(this);engine.addSystem(this)}setStartTime(e){this.state.startTime=e}getPlayerScreen(e){return this["screen"+e]}init(){this.state.initialized=1;this.scene.setParent(this.root)}tempBlock(){this.state.blocked=1;this["screen"+this.gameSetup.currentPlayer].showCross();r.playOnce("fail");setTimeout(()=>{this.state.blocked=0;this["screen"+this.gameSetup.currentPlayer].hideCross()},1e3)}moveLeg1(){if(this.state.blocked||!this.state.started)return;const e=this.getPlayerScreen(this.gameSetup.currentPlayer);if(this.state.blocked||1!==this.state.currentLeg||e.getScreenState().moving)return;e.moveScreen();this.state.currentLeg=2;e.getNextStepValue()?this.tempBlock():r.playOnce("ok");const t=this.getPercentage(this.gameSetup.currentPlayer);void 0;this.ui.updateScore({player:this.gameSetup.currentPlayer,score:t});this.callbacks.onShareState({movement:"1",player:this.gameSetup.currentPlayer,percentage:t})}moveLeg2(){if(this.state.blocked||!this.state.started)return;const e=this.getPlayerScreen(this.gameSetup.currentPlayer);if(this.state.blocked||2!==this.state.currentLeg||e.getScreenState().moving)return;e.moveScreen();this.state.currentLeg=1;e.getNextStepValue()?this.tempBlock():r.playOnce("ok");const t=this.getPercentage(this.gameSetup.currentPlayer);this.ui.updateScore({player:this.gameSetup.currentPlayer,score:t});this.callbacks.onShareState({movement:"2",player:this.gameSetup.currentPlayer,percentage:t})}jump(){if(this.state.blocked||!this.state.started)return;const e=this.getPlayerScreen(this.gameSetup.currentPlayer);if(1!==e.getNextStepValue())return;if(e.getScreenState().moving)return;e.moveScreen(1);const t=this.getPercentage(this.gameSetup.currentPlayer,1);this.ui.updateScore({player:this.gameSetup.currentPlayer,score:t});this.callbacks.onShareState({movement:"jump",player:this.gameSetup.currentPlayer,percentage:t});r.playOnce("jump")}getPercentage(e,t){const n=this["screen"+e].getScreenState().currentStep+(t?2:1),i=this["screen"+e].getTotalSteps()-4;return Math.floor(100*n/i)}start(){this.state.started=1;(()=>i(this,void 0,void 0,(function*(){r.playLoop("race",{volume:.5});yield u(3e3);r.playOnce("readygo");a.updateTextPanel({value:"READY!"});yield u(700);a.updateTextPanel({value:"STEADY!"});yield u(800);a.updateTextPanel({value:"GO!"});void 0;const e=this.getPlayerScreen(this.gameSetup.currentPlayer);this.state.blocked=0;if(this.gameSetup.currentPlayer){this.state.blocked=0;Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,0,this.moveLeg1);Input.instance.subscribe("BUTTON_DOWN",ActionButton.SECONDARY,0,this.moveLeg2);Input.instance.subscribe("BUTTON_DOWN",ActionButton.POINTER,0,this.jump)}e.onMove(e=>{e%2==0});e.onFinishScreen(()=>{this.block();r.stopSound("race");const e=Date.now()-this.state.startTime;this.callbacks.onFinish({time:e,isWinner:1,gameIndex:this.gameSetup.gameIndex,roundIndex:0});this.ui.updateTime({player:this.gameSetup.currentPlayer,time:e});this.ui.updateScore({player:this.gameSetup.currentPlayer,score:100});this.callbacks.onShareState({player:this.gameSetup.currentPlayer,timeSinceStart:e,percentage:100})});this.screen1.handleVisibility();this.screen2.handleVisibility();yield u(1e3);a.updateTextPanel({value:""})})))()}update(e){if(this.state.initialized)if(!this.state.started&&Date.now()-4e3>=this.state.startTime)this.start();else{this.state.started&&this.getPlayerScreen(1).getScreenState().moving&&this.getPlayerScreen(1).updateScreen(e);this.state.started&&this.getPlayerScreen(2).getScreenState().moving&&this.getPlayerScreen(2).updateScreen(e)}}destroy(){r.stopSound("race");a.updateTextPanel({value:""});Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.PRIMARY,this.moveLeg1);Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.SECONDARY,this.moveLeg2);Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.POINTER,this.jump);this.scene.setParent(null);engine.removeEntity(this.scene);engine.removeSystem(this)}block(){this.state.blocked=1;Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.PRIMARY,this.moveLeg1);Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.SECONDARY,this.moveLeg2);Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.POINTER,this.jump)}finish({winner:e}){const t=1===e?2:1;this.roundResult1.show();this.roundResult2.show();this["roundResult"+e].update(1);this["roundResult"+t].update(0)}onFinish(e){this.callbacks.onFinish=e;return()=>this.callbacks.onFinish=null}onShareState(e){this.callbacks.onShareState=e;return()=>this.callbacks.onShareState=null}shareState(e){void 0;const{movement:t,player:n,timeSinceStart:i,percentage:s}=e;if(i)this.ui.updateTime({player:n,time:i});else{const e=this.getPlayerScreen(n);"1"===t||"2"===t?e.moveScreen():e.moveScreen(1)}this.ui.updateScore({player:n,score:s})}getRandomInt(e,t,n){const i=Math.floor(this.randomizer.random()*(t-e+1))+e;return i===n?this.getRandomInt(e,t,n):i}}t.ObstacleGame=h;h.id="Obstacle";h.instructions="Alternate E and F  with rythm to run,\n    when red obstacle right in front,\n    Press click to jump!\n    ";function u(e){return new Promise(t=>setTimeout(t,e))}},function(e,t,n){var i=this&&this.__decorate||function(e,t,n,i){var s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i,r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:1});t.createScreen=void 0;const s=n(1),o=n(0),r=n(21),a=.3;let l=class e{constructor(e,t){this.index=e;this.isObstacle=t}};l=i([Component("ObstacleGame-step")],l);let c=class e{};c=i([Component("ObstacleGame-player")],c);t.createScreen=(e,{player:t,track:n})=>{let i=new TextShape("E");i.withCollisions=0;i.fontSize=4;i.font=new Font(Fonts.SanFrancisco_Heavy);i.shadowOffsetX=1;i.shadowOffsetY=1;i.shadowColor=Color3.FromHexString("#000000");const c={onMove:null,onFinish:null},h={moving:0,jumping:0,moveCount:0,currentStep:0,jumps:0};let u;u=new Entity;u.setParent(e);const d=r.createCross(u,{position:new Vector3(1.5,3,-.001),scale:new Vector3(1,1,1)});d.hide();u.addComponent(new Transform({position:new Vector3(2===t?0:-3,0,0)}));const p=new Entity,m=new PlaneShape;m.withCollisions=0;m.uvs=o.getSpriteUv(2,11,96,128);p.addComponent(s.spriteMaterial);p.addComponent(m);p.addComponent(new Transform({position:new Vector3(1.5,2,0),scale:new Vector3(3,4,1)}));p.setParent(u);const g=2060,S=new o.SpriteAnimationSystem(u,{frames:[{uvs:o.getSpriteUv(8,g,16,16)},{uvs:o.getSpriteUv(1,g,16,16)},{uvs:o.getSpriteUv(2,g,16,16)},{uvs:o.getSpriteUv(3,g,16,16)},{uvs:o.getSpriteUv(4,g,16,16)},{uvs:o.getSpriteUv(4,g,16,16)},{uvs:o.getSpriteUv(5,g,16,16)},{uvs:o.getSpriteUv(6,g,16,16)},{uvs:o.getSpriteUv(7,g,16,16)},{uvs:o.getSpriteUv(8,g,16,16)},{uvs:o.getSpriteUv(8,g+64,16,16)}],scale:new Vector3(.5,.5,1),position:new Vector3(.3*3+.15,1.9,-.002),time:.1});S.init();const y=[];n.forEach((e,i)=>{const s=new Entity;s.addComponent(new l(i,e));const o=new PlaneShape;o.withCollisions=0;const r=new Material;r.transparencyMode=TransparencyMode.ALPHA_BLEND;r.albedoColor=e?new Color4(1,0,0,0):1===t?new Color4(0,0,1,0):new Color4(1,1,0,0);r.emissiveColor=e?new Color3(1,0,0):1===t?Color3.FromHexString("#0000ff"):Color3.FromHexString("#ffff00");r.emissiveIntensity=3;if(i===n.length-1){r.albedoColor=new Color4(0,1,0,0);r.emissiveColor=new Color3(0,1,0)}s.addComponent(o);s.addComponent(r);e?s.addComponent(new Transform({position:new Vector3(.3*i+.15-.1,1.75,-.001),scale:new Vector3(.1,.1,1)})):s.addComponent(new Transform({position:new Vector3(.3*i+.15,1.95,-.001),scale:new Vector3(.02,.02,1)}));y.push(s);s.setParent(u)});const f=new Entity;f.addComponent(i);f.addComponent(new Transform({position:new Vector3(1,1.3,-.002)}));f.setParent(u);const T=e=>e>a?Math.max(0,.4-h.moveCount/a*.4/2):Math.min(.4,h.moveCount/a*.4),b=()=>{Object.values(y).forEach((e,t)=>{e.visible=0})},w=undefined,v=undefined,C=undefined,P=undefined,R=undefined,E=()=>{y.forEach((e,i)=>{const s=e.getComponent(Transform),o=e.getComponent(PlaneShape),r=e.getComponent(Material),a=e.getComponent(l).isObstacle;if(s.position.x<.2||s.position.x>=2.999)r.albedoColor=a?new Color4(1,0,0,0):1===t?new Color4(0,0,1,0):new Color4(1,1,0,0);else{r.albedoColor=a?new Color4(1,0,0,1):1===t?new Color4(0,0,1,1):new Color4(1,1,0,1);if(i===n.length-1){r.albedoColor=new Color4(0,1,0,1);r.emissiveColor=new Color3(0,1,0)}}});n[h.currentStep+4]?i.value="CLICK":h.currentStep%2==0?i.value="E":i.value="F"},_=e=>{if(h.moving){h.moveCount+=e;y.forEach((e,t)=>{const n=undefined,i=e.getComponent(Transform).position,s=.3*t+.15,o=.3*h.currentStep,r=h.moveCount/a*.3;i.set(s-o-r,i.y,i.z)});if(h.jumping){const e=S.globalOptions.position,t=T(h.moveCount);e.set(e.x,t+1.9,e.z)}}if(h.moveCount>=(h.jumping?2*a:a)){h.jumping&&h.jumps++;h.currentStep+=h.jumping?2:1;h.moving=h.jumping=0;h.moveCount=0;c.onMove&&c.onMove(h.currentStep);c.onFinish&&h.currentStep+3===n.length-1&&c.onFinish();E()}},I=undefined;return{getNextStepValue:()=>n[h.currentStep+1+3],moveScreen:e=>{h.moving=1;h.jumping=!!e;S.state.playing||(e?S.play([9,0,1],{loop:0,time:.2}):h.currentStep%2==0?S.play([1,2,3],{loop:0,time:.1}):S.play([5,6,7],{loop:0,time:.1}))},getScreenState:()=>h,onMove:e=>{c.onMove=e;return()=>c.onMove=null},onFinishScreen:e=>{c.onFinish=e;return()=>c.onFinish=null},handleVisibility:E,updateScreen:_,destroy:()=>{u.setParent(null);engine.removeEntity(u);c.onFinish=null;c.onMove=null},getTotalSteps:()=>n.length,showCross:()=>d.show(),hideCross:()=>d.hide()}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.MathGame=void 0;const i=n(2),s=n(1),o=n(7),r=n(3),a=n(6),l=n(0),c=n(4),h=5,u=4/128,d=144,p=(e,{player:t})=>{const n=new Entity,i=new PlaneShape;i.withCollisions=0;i.uvs=l.getSpriteUv(1,d,64,64);n.addComponent(s.spriteMaterial);n.addComponent(i);n.addComponent(new Transform({position:new Vector3(1===t?-(2.2+2*u):2.2-3*u,1.5-2*u,-.002),scale:new Vector3(1===t?2:-2,2,1)}));n.setParent(e);return i};class m{constructor(e,{seed:t,level:n,currentPlayer:i,gameIndex:s}){this.state={blocked:0,started:0,initialized:0,startTime:Number.MAX_VALUE,roundStartTime:Number.MAX_VALUE,lastRoundStartTime:Number.MAX_VALUE,waitingRound:0,round:0,finished:0,score1:0,score2:0};this.callbacks={onFinish:null,onShareState:null,onFinishRound:null};this.scene=new Entity;this.scene.addComponent(new Transform({position:new Vector3(0,0,-.002)}));this.ui=c.createUI(this.scene);this.teacher1=p(this.scene,{player:1});this.teacher2=p(this.scene,{player:2});this.player1=c.createPlayerAnswer(this.scene,{player:1});this.player2=c.createPlayerAnswer(this.scene,{player:2});this.player1.hide();this.player2.hide();this.roundResult1=c.createRoundResult(this.scene,{player:1});this.roundResult2=c.createRoundResult(this.scene,{player:2});this.roundResult1.hide();this.roundResult2.hide();this.gameSetup={seed:t,currentPlayer:i,level:n,gameIndex:s};this.root=e;this.randomizer=r.seedGen.create(t.toString());const o=new Entity;this.question=new TextShape("");this.question.withCollisions=0;this.question.vTextAlign="top";this.question.fontSize=5;o.addComponent(this.question);o.addComponent(new Transform({position:new Vector3(0,3.5,-.001)}));o.setParent(this.scene);engine.addSystem(this)}setStartTime(e){this.state.startTime=e}setRoundStartTime(e){void 0;this.state.roundStartTime=e}onClickAnswer(e){if(this.state.blocked||!this.state.started)return;this.state.blocked=1;i.playOnce("swing");const t=this["player"+this.gameSetup.currentPlayer];t.show();t.wrapperEntity.getComponent(Transform).position.set(this.answersT[e].position.x+(1===this.gameSetup.currentPlayer?-.2:.2),this.answersT[e].position.y,this.answersT[e].position.z);const n=this.answers[e].value===this.answers[this.solutionIndex].value;t.setSprite(n);const s=a.getTimeSinceStart(0===this.state.round?this.state.startTime:this.state.lastRoundStartTime),o=n?s:999999999-s;this.callbacks.onShareState({type:"election",player:this.gameSetup.currentPlayer,index:e,time:o,timeSinceStart:s,round:this.state.round});this.ui.updateTime({player:this.gameSetup.currentPlayer,time:s});if(this.state.round<h-1){this.callbacks.onFinishRound({player:this.gameSetup.currentPlayer,time:o,round:this.state.round,isWinner:n,gameIndex:this.gameSetup.gameIndex,roundIndex:this.state.round});this.state.waitingRound=1}else this.callbacks.onFinish({player:this.gameSetup.currentPlayer,time:o,round:this.state.round,isWinner:n,gameIndex:this.gameSetup.gameIndex,roundIndex:this.state.round})}init(){i.playLoop("money",{volume:.5});this.state.initialized=1;o.updateSpritePanel({uvs:l.getSpriteUv(3,0,192,128)});o.showSpritePanel();this.scene.setParent(this.root)}block(){this.state.blocked=1}destroy(){i.stopSound("money");o.hideSpritePanel();this.scene.setParent(null);engine.removeEntity(this.scene)}start(){this.ui.hideTime();const e=Math.floor(50*this.randomizer.random()),t=Math.floor(50*this.randomizer.random());this.question.value=`${e} + ${t}`;this.state.started=1;const n=e+t,i=this.solutionIndex=Math.floor(6*this.randomizer.random()),s=n-1,o=this.getRandomIntExcept(0,5,[i]),r=n-10,a=this.getRandomIntExcept(0,5,[i,o]);this.answers=Array(6).fill(null);this.answersT=Array(6).fill(null);const l=[],c=new PlaneShape,h=new Material;h.albedoColor=new Color4(1,1,1,.05);this.answers.forEach((e,t)=>{const u=new Entity,d=new Entity;c.withCollisions=0;d.addComponent(c);d.addComponent(h);this.answers[t]=new TextShape;this.answers[t].withCollisions=0;this.answers[t].fontSize=3;u.addComponent(this.answers[t]);this.answers[t].value=l[t]=t===i?n:t===o?s:t===a?r:this.getRandomIntExcept(0,100,l);this.answers[t].visible=0;u.addComponent(new Transform({position:new Vector3(0,0,-.01)}));this.answersT[t]=new Transform({position:new Vector3(0===t||3===t?-1:1===t||4===t?0:1,t<3?2.5:1.5,0),scale:new Vector3(.9,.9,.9)});d.addComponent(this.answersT[t]);d.addComponent(new OnClick(()=>{this.onClickAnswer(t)}));d.setParent(this.scene);u.setParent(d)})}startRound(){this.state.round++;this.roundResult1.hide();this.roundResult2.hide();this.ui.hideTime();this.player1.hide();this.player2.hide();this.question.value="";this.state.lastRoundStartTime=this.state.roundStartTime;this.state.roundStartTime=Number.MAX_VALUE;this.state.waitingRound=0;this.answers.forEach((e,t)=>{this.answers[t].value=""});this.question.value="";this.teacher1.uvs=l.getSpriteUv(1,d,64,64);this.teacher2.uvs=l.getSpriteUv(1,d,64,64);setTimeout(()=>{this.gameSetup.currentPlayer&&(this.state.blocked=0);const e=Math.floor(50*this.randomizer.random()),t=Math.floor(50*this.randomizer.random());this.question.value=`${e} + ${t}`;const n=e+t,i=this.solutionIndex=Math.floor(6*this.randomizer.random()),s=n-1,o=this.getRandomIntExcept(0,5,[i]),r=n-10,a=this.getRandomIntExcept(0,5,[i,o]),l=[];this.answers.forEach((e,t)=>{this.answers[t].value=l[t]=t===i?n:t===o?s:t===a?r:this.getRandomIntExcept(0,100,l)})},500)}update(e){if(this.state.initialized)if(!this.state.waitingRound&&!this.state.started&&Date.now()>=this.state.startTime){void 0;this.start()}else this.state.started&&this.state.waitingRound&&Date.now()>=this.state.roundStartTime?this.startRound():Date.now()>=this.state.roundStartTime}finish(e){const{winner:t}=e,n=1===t?2:1;this.state.blocked=1;this["teacher"+t].uvs=l.getSpriteUv(3,d,64,64);this["teacher"+n].uvs=l.getSpriteUv(2,d,64,64);t===this.gameSetup.currentPlayer?i.playOnce("wow"):i.playOnce("fail");this.roundResult1.show();this.roundResult2.show();this["roundResult"+t].update(1);this["roundResult"+n].update(0)}finishRound({winner:e}){void 0;this.state.blocked=1;this.state["score"+e]+=1;this.ui.updateScore({player:e,score:this.state["score"+e]});const t=1===e?2:1;void 0;this["teacher"+e].uvs=l.getSpriteUv(3,d,64,64);this["teacher"+t].uvs=l.getSpriteUv(2,d,64,64);e===this.gameSetup.currentPlayer?i.playOnce("wow"):i.playOnce("fail");this["roundResult"+e].update(1);this["roundResult"+t].update(0);this.roundResult1.show();this.roundResult2.show();this.state.waitingRound=1}onFinish(e){this.callbacks.onFinish=e}onFinishRound(e){this.callbacks.onFinishRound=e;return()=>this.callbacks.onFinishRound=null}shareState(e){const{player:t,index:n,timeSinceStart:i,time:s,round:o}=e;if(o!==this.state.round)return;const r=n===this.solutionIndex,a=this["player"+t];a.show();a.wrapperEntity.getComponent(Transform).position.set(this.answersT[n].position.x+(1===t?-.2:.2),this.answersT[n].position.y,this.answersT[n].position.z);a.setSprite(r);this.ui.updateTime({player:t,time:i})}onShareState(e){this.callbacks.onShareState=e}getRandomIntExcept(e,t,n){let i=e+Math.floor(this.randomizer.random()*(t+1-e));if(!n)return i;for(;~n.indexOf(i);)i=e+Math.floor(this.randomizer.random()*(t+1-e));return i}}t.MathGame=m;m.id="Math";m.instructions="Math\nClick the correct answer"},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.SammichGame=void 0;const i=n(42),s=n(2),o=n(4),r=5;class a{constructor(e,{currentPlayer:t,seed:n,level:s,gameIndex:r}){this.gameSetup={level:1,currentPlayer:0,seed:null};this.callbacks={onFinish:null,onShareState:null,onFinishRound:null};this.state={started:0,initialized:0,blocked:0,startTime:Number.MAX_VALUE,roundStartTime:Number.MAX_VALUE,lastRoundStartTime:Number.MAX_VALUE,waitingRound:0,round:0,score:0,score1:0,score2:0};this.scene=new Entity;this.scene.addComponent(new Transform({position:new Vector3(0,2,-.001)}));this.ui=o.createUI(this.scene,{position:new Vector3(0,-2,0)});this.root=e;this.gameSetup={currentPlayer:t,seed:n,level:s,gameIndex:r};this.screen1=i.createScreen(this.scene,{player:1,seed:n,owner:1===t});this.screen2=i.createScreen(this.scene,{player:2,seed:n,owner:2===t});t&&this["screen"+t].onStateChange(e=>{void 0;void 0;this.ui.updateScore({player:this.gameSetup.currentPlayer,score:e.score+this.state.score});this.callbacks.onShareState({player:t,state:e,score:e.score+this.state.score})});engine.addSystem(this);this.roundResult1=o.createRoundResult(this.scene,{player:1});this.roundResult2=o.createRoundResult(this.scene,{player:2});const a=this.roundResult1.getTransform().position,l=this.roundResult2.getTransform().position;a.set(a.x,a.y-2,a.z);l.set(l.x,l.y-2,l.z);this.roundResult1.hide();this.roundResult2.hide()}startRound(){this.state.round++;this.state.lastRoundStartTime=this.state.roundStartTime;this.state.roundStartTime=Number.MAX_VALUE;this.state.waitingRound=0;this.gameSetup.currentPlayer&&this["screen"+this.gameSetup.currentPlayer].start({level:this.state.round})}setRoundStartTime(e){this.state.roundStartTime=e}setStartTime(e){this.state.startTime=e}block(){this.state.blocked=1}init(){this.scene.setParent(this.root);this.state.initialized=1;s.playLoop("music2",{volume:.5})}start(){void 0;this.state.started=1;this.state.startTime=Number.MAX_VALUE;this.state.roundStartTime=Number.MAX_VALUE;this.screen1.start({level:this.state.round+1});this.screen2.start({level:this.state.round+1});this.gameSetup.currentPlayer&&this["screen"+this.gameSetup.currentPlayer].onComplete(e=>{e>=6?s.playOnce("wow"):e>=4;this.state.score+=e;this.state["score"+this.gameSetup.currentPlayer]=this.state.score;const t=this.state["score"+this.gameSetup.currentPlayer];this.ui.updateScore({player:this.gameSetup.currentPlayer,score:t});void 0;setTimeout(()=>{void 0;if(this.state.round<r-1||this.state.score1===this.state.score2)this.callbacks.onFinishRound({player:this.gameSetup.currentPlayer,score:t,gameIndex:this.gameSetup.gameIndex,roundIndex:this.state.round});else{void 0;s.stopSound("music2");this.callbacks.onFinish({isWinner:1,time:-1*t,score:t,gameIndex:this.gameSetup.gameIndex,roundIndex:this.state.round})}},1e3)})}finish({winner:e}){const t=1===e?2:1;this.roundResult1.show();this.roundResult2.show();this["roundResult"+e].update(1);this["roundResult"+t].update(0)}finishRound({winner:e}){this.state.waitingRound=1;this.screen1.reset();this.screen2.reset()}destroy(){this.screen1.dispose();this.screen2.dispose();this.scene.setParent(null);engine.removeEntity(this.scene);engine.removeSystem(this)}shareState(e){const t=e.state,n=e.player;void 0;this.ui.updateScore({player:n,score:e.score});this["screen"+n].setState(t);this.state["score"+n]=e.score}onShareState(e){this.callbacks.onShareState=e;return()=>this.callbacks.onShareState=null}onFinish(e){this.callbacks.onFinish=e;return()=>this.callbacks.onFinish=null}onFinishRound(e){this.callbacks.onFinishRound=e;return()=>this.callbacks.onFinishRound=null}update(e){if(this.state.initialized)if(!this.state.waitingRound&&!this.state.started&&Date.now()>=this.state.startTime)this.start();else{this.state.started&&this.state.waitingRound&&Date.now()>=this.state.roundStartTime&&this.startRound();if(!this.state.waitingRound&&this.state.started){this.getPlayerScreen(1).getScreenState().idle||this.getPlayerScreen(1).updateScreen(e);this.getPlayerScreen(2).getScreenState().idle||this.getPlayerScreen(2).updateScreen(e)}}}getPlayerScreen(e){return this["screen"+e]}}t.SammichGame=a;a.id="Sammich";a.instructions="Move to sides with E and F\nto build the perfect sammich"},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.createScreen=void 0;const i=n(1),s=n(0),o=n(2),r=n(3),a=[1,2,3,4,6,7,8],l=(e,{spriteIndex:t,position:n})=>{const o=new Entity;o.setParent(e);const r=new PlaneShape;r.withCollisions=0;o.addComponent(i.spriteMaterial);o.addComponent(r);const a=new Transform({scale:new Vector3(.5,.5,.5),position:n});o.addComponent(a);r.uvs=s.getSpriteUv(t,2048,16,16);const l={onBase:0,baseX:0,currentRound:1};return{setX:e=>{a.position.set(e,a.position.y,a.position.z)},setY:e=>{a.position.set(a.position.x,e,a.position.z)},getX:()=>a.position.x,getY:()=>a.position.y,isOnBase:()=>l.onBase,getBaseX:()=>l.baseX,setOnBase:(e,t)=>{l.onBase=e;l.baseX=t},dispose:()=>{o.setParent(null);o.removeComponent(Transform);o.removeComponent(i.spriteMaterial);o.removeComponent(PlaneShape);engine.removeEntity(o)}}};t.createScreen=(e,{seed:t,player:n,owner:c})=>{const h=new Entity,u={dtCount:0,idle:1,level:1,basePosition:0,layers:[],score:0},d=r.seedGen.create(t.toString()),p=new PlaneShape;p.withCollisions=0;p.uvs=s.getSpriteUv(1,11,96,128);h.setParent(e);h.addComponent(new Transform({position:new Vector3(1===n?-1.5:1.5,0,-0)}));const m=new Entity,g=new Transform({scale:new Vector3(3,4,1)});m.addComponent(p);m.addComponent(i.spriteMaterial);m.addComponent(g);m.setParent(h);const S=l(h,{spriteIndex:9,position:new Vector3(0,-1.125,-.002)}),y=.25,f=e=>{Object.assign(u,e);S.setX(u.basePosition);u.layers.forEach((e,t)=>{_[t].setX(S.getX()+e);const n=S.getY()+t*C+P;_[t].setY(n)})},T=e=>{Object.assign(u,e);x.onStateChange&&x.onStateChange(u)},b=e=>{x.onStateChange=e;return()=>x.onStateChange=null},w=()=>{if(u.idle&&!c)return;const e=S.getX()===+y?+y:S.getX()+y;S.setX(e);_.forEach(e=>{e.isOnBase()&&e.setX(S.getX()-e.getBaseX())});T({basePosition:S.getX()})},v=()=>{if(u.idle&&!c)return;const e=S.getX()===-y?-y:S.getX()-y;S.setX(e);_.forEach((e,t)=>{e.isOnBase()&&e.setX(S.getX()-e.getBaseX())});T({basePosition:S.getX()})};if(c){Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,0,v);Input.instance.subscribe("BUTTON_DOWN",ActionButton.SECONDARY,0,w)}const C=.05,P=.1,R=7,E=e=>{if(u.idle)return;const t=.7*Math.min(u.level,R)+.2,n=1.75;u.dtCount+=e;_.forEach((e,i)=>{const s=i/t+.03*i*t;if(u.dtCount>=s){const r=S.getY()+i*C+P;if(e.getY()<=r){if(!c)return;if(!e.isOnBase()){e.setOnBase(1,S.getX()-e.getX());if(0!==e.getBaseX())o.playOnce("fail");else{o.playOnce("ok");u.score++}T({score:u.score,layers:[...u.layers,e.getX()-S.getX()]})}}else e.setY(Math.max(r,n-(u.dtCount-s)*t))}});if(c&&_.every((e,t)=>e.isOnBase())){u.idle=1;let e=0;_.forEach((t,n)=>{0===t.getBaseX()&&e++});x.onComplete&&x.onComplete(e);u.score=0}};let _=[];const I=()=>{_=Array(5).fill(null).map((e,t)=>{const n=d.random();let i=Math.floor(3*n-1)*y;const s=a[Math.floor(n*a.length)],o=new Vector3(i,1.75,-.001*t-.004),r=undefined;return l(h,{spriteIndex:s,position:o})});const e=d.random();let t=Math.floor(3*e-1)*y;_.push(l(h,{spriteIndex:5,position:new Vector3(t,1.75,-.005-.004)}))};I();const A=undefined,O=undefined,x={onComplete:null,onStateChange:null},k=undefined,N=undefined,F=undefined;return{getScreenState:()=>u,start:({level:e})=>{u.idle=0;u.level=e},updateScreen:E,onComplete:e=>{x.onComplete=e;return()=>x.onComplete=null},reset:()=>{u.idle=1;u.dtCount=0;u.layers=[];u.basePosition=0;u.score=0;_.forEach((e,t)=>{e.dispose()});I()},setState:f,onStateChange:b,dispose:()=>{Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.PRIMARY,v);Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.SECONDARY,w)}}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.DifferentGame=void 0;const i=n(4),s=n(3),o=n(1),r=n(0),a=n(2),l=n(7),c=n(13),h=n(6),u=192,d=(e,t,n)=>{const i=new Entity,s=new PlaneShape;let a=0;i.addComponent(s);i.addComponent(o.spriteMaterial);i.addComponent(new Transform({scale:new Vector3(1.9,1.9,1.9),position:new Vector3(0===t?-2:1===t?0:2,2,-.001)}));s.uvs=r.getSpriteUv(1,u,64,64);s.uvs=r.getSpriteUv(0,0,0,0);i.setParent(e);i.addComponent(new OnClick(()=>{n(t)}));return{setIndex:e=>{a=e;s.uvs=r.getSpriteUv(a,u,64,64)},getSpriteIndex:()=>a,hide:()=>{s.uvs=r.getSpriteUv(0,0,0,0)}}},p=5;class m{constructor(e,{seed:t,level:n,currentPlayer:o,gameIndex:r}){this.callbacks={onFinish:null,onShareState:null,onFinishRound:null};this.state={blocked:0,started:0,initialized:0,startTime:Number.MAX_VALUE,roundStartTime:Number.MAX_VALUE,lastRoundStartTime:Number.MAX_VALUE,waitingRound:0,round:0,finished:0,score1:0,score2:0,equalSpriteIndex:0,differentSpriteIndex:0,answerPositions:[1,0,0]};this.gameSetup={seed:t,currentPlayer:o,level:n,gameIndex:r};this.root=e;this.scene=new Entity;this.scene.addComponent(new Transform({position:new Vector3(0,0,-.002)}));this.ui=i.createUI(this.scene);this.player1=i.createPlayerAnswer(this.scene,{player:1});this.player2=i.createPlayerAnswer(this.scene,{player:2});this.player1.hide();this.player2.hide();void 0;this.randomizer=s.seedGen.create(t.toString());this.onClickAnswer=this.onClickAnswer.bind(this);this.answers=[0,1,2].map(e=>d(this.scene,e,this.onClickAnswer));engine.addSystem(this);o||(this.state.blocked=1)}onClickAnswer(e){if(this.state.blocked||!this.state.started)return;this.state.blocked=1;a.playOnce("swing");const t=!!this.state.answerPositions[e];void 0;const n=this["player"+this.gameSetup.currentPlayer];n.show();n.wrapperEntity.getComponent(Transform).position.set((0===e?-2:1===e?0:2)+(1===this.gameSetup.currentPlayer?-.5:.5),2,-.002);n.setSprite(t);const i=h.getTimeSinceStart(0===this.state.round?this.state.startTime:this.state.lastRoundStartTime),s=t?i:999999999-i;this.callbacks.onShareState({player:this.gameSetup.currentPlayer,isWinner:t,answerIndex:e,time:s,timeSinceStart:i,round:this.state.round});this.ui.updateTime({player:this.gameSetup.currentPlayer,time:i});if(this.state.round<p-1){this.callbacks.onFinishRound({player:this.gameSetup.currentPlayer,time:s,roundIndex:this.state.round,gameIndex:this.gameSetup.gameIndex});this.state.waitingRound=1}else this.callbacks.onFinish({player:this.gameSetup.currentPlayer,time:s,roundIndex:this.state.round,gameIndex:this.gameSetup.gameIndex})}init(){c.updateTextPanel({value:"Which is different?",color:Color3.Black()});a.playLoop("money",{volume:.5});this.state.initialized=1;l.updateSpritePanel({uvs:r.getSpriteUv(9,0,192,128)});l.showSpritePanel();this.scene.setParent(this.root)}setStartTime(e){void 0;this.state.startTime=e}setRoundStartTime(e){this.state.roundStartTime=e}finish(e){const{winner:t}=e,n=1===t?2:1;this.state.blocked=1;t===this.gameSetup.currentPlayer?a.playOnce("wow"):a.playOnce("fail")}finishRound({winner:e}){this.state.blocked=1;this.state["score"+e]+=1;this.ui.updateScore({player:e,score:this.state["score"+e]});const t=1===e?2:1;e===this.gameSetup.currentPlayer?a.playOnce("wow"):a.playOnce("fail");this.state.waitingRound=1}reproduceRound(){this.gameSetup.currentPlayer&&(this.state.blocked=0);this.ui.hideTime();c.updateTextPanel({value:"Which is different?",color:Color3.Black()});this.state.equalSpriteIndex=this.getRandomIntExcept(1,9);this.state.differentSpriteIndex=this.getRandomIntExcept(1,9,[this.state.equalSpriteIndex]);void 0;this.state.answerPositions=g([1,0,0],this.randomizer.random);this.state.answerPositions.forEach((e,t)=>{e?this.answers[t].setIndex(this.state.differentSpriteIndex):this.answers[t].setIndex(this.state.equalSpriteIndex)})}start(){void 0;this.state.started=1;this.reproduceRound()}startRound(){this.state.round++;this.player1.hide();this.player2.hide();this.state.lastRoundStartTime=this.state.roundStartTime;this.state.roundStartTime=Number.MAX_VALUE;this.state.waitingRound=0;this.answers.forEach(e=>e.hide());setTimeout(()=>{this.reproduceRound()},500)}block(){this.state.blocked=1}update(e){this.state.initialized&&(!this.state.waitingRound&&!this.state.started&&Date.now()>=this.state.startTime?this.start():this.state.started&&this.state.waitingRound&&Date.now()>=this.state.roundStartTime&&this.startRound())}shareState({player:e,answerIndex:t,isWinner:n,timeSinceStart:i,round:s}){this.ui.updateTime({player:e,time:i});const o=this["player"+e],r=t;o.setSprite(n);o.show();o.wrapperEntity.getComponent(Transform).position.set((0===r?-2:1===r?0:2)+(1===e?-.5:.5),2,-.002)}destroy(){a.stopSound("money");l.hideSpritePanel();this.scene.setParent(null);engine.removeEntity(this.scene)}onFinish(e){this.callbacks.onFinish=e}onFinishRound(e){this.callbacks.onFinishRound=e}onShareState(e){this.callbacks.onShareState=e}getRandomIntExcept(e,t,n){let i=e+Math.floor(this.randomizer.random()*(t+1-e));if(!n)return i;for(;~n.indexOf(i);)i=e+Math.floor(this.randomizer.random()*(t+1-e));return i}}t.DifferentGame=m;m.id="Different";m.instructions="Different\nClick the image that is different";function g(e,t){for(var n=e.length,i,s;0!==n;){s=Math.floor(t()*n);i=e[n-=1];e[n]=e[s];e[s]=i}return e}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.FroggerGame=void 0;const i=n(45),s=n(3),o=n(4),r=n(2),a=n(13),l={UP:ActionButton.POINTER,LEFT:ActionButton.PRIMARY,RIGHT:ActionButton.SECONDARY};class c{constructor(e,{seed:t,currentPlayer:n,level:r=1,gameIndex:a}){this.callbacks={onFinish:null,onShareState:null};this.state={blocked:0,started:0,initialized:0,startTime:Number.MAX_VALUE,finished:0};this.root=e;this.scene=new Entity;this.scene.addComponent(new Transform({position:new Vector3(0,0,-.001)}));this.ui=o.createUI(this.scene);this.gameSetup={seed:t,currentPlayer:n,level:r,gameIndex:a};this.randomizer=s.seedGen.create(t.toString());this.screen1=i.createScreen(this.scene,{player:1,seed:t});this.screen2=i.createScreen(this.scene,{player:2,seed:t});this.roundResult1=o.createRoundResult(this.scene,{player:1});this.roundResult2=o.createRoundResult(this.scene,{player:2});this.roundResult1.hide();this.roundResult2.hide();n&&this["screen"+n].onStateChange(e=>{this.ui.updateScore({score:e.score,player:n});const{x:t,y:i,z:s}=e.frogPosition;this.callbacks.onShareState(Object.assign(Object.assign({},e),{player:n,frogPosition:{x:t,y:i,z:s},takenSammiches:e.takenSammiches}));void 0;if(5===e.score&&!this.state.finished){const e=Date.now()-this.state.startTime;this.block();n&&this["screen"+n].block();this.state.finished=1;this.callbacks.onFinish({isWinner:1,time:e,player:n,gameIndex:this.gameSetup.gameIndex,roundIndex:0})}});engine.addSystem(this);this.up=this.up.bind(this);this.left=this.left.bind(this);this.right=this.right.bind(this)}setStartTime(e){this.state.startTime=e}getPlayerScreen(e){return this["screen"+e]}init(){this.state.initialized=1;this.scene.setParent(this.root);r.playLoop("race",{volume:.5})}start(){void 0;this.state.started=1;if(this.gameSetup.currentPlayer){Input.instance.subscribe("BUTTON_DOWN",l.UP,0,this.up);Input.instance.subscribe("BUTTON_DOWN",l.LEFT,0,this.left);Input.instance.subscribe("BUTTON_DOWN",l.RIGHT,0,this.right)}}up(){var e;this.state.started&&!this.state.blocked&&(null===(e=this.getPlayerScreen(this.gameSetup.currentPlayer))||void 0===e?void 0:e.up())}left(){var e;this.state.started&&!this.state.blocked&&(null===(e=this.getPlayerScreen(this.gameSetup.currentPlayer))||void 0===e?void 0:e.left())}right(){var e;this.state.started&&!this.state.blocked&&(null===(e=this.getPlayerScreen(this.gameSetup.currentPlayer))||void 0===e?void 0:e.right())}update(e){if(this.state.initialized)if(!this.state.started&&Date.now()-4e3>=this.state.startTime)this.start();else{this.state.started&&this.getPlayerScreen(1).updateScreen(e,1===this.gameSetup.currentPlayer);this.state.started&&this.getPlayerScreen(2).updateScreen(e,2===this.gameSetup.currentPlayer)}}block(){this.state.blocked=1;this.gameSetup.currentPlayer&&this["screen"+this.gameSetup.currentPlayer].block()}destroy(){void 0;r.stopSound("race");a.updateTextPanel({value:""});Input.instance.unsubscribe("BUTTON_DOWN",l.UP,this.up);Input.instance.unsubscribe("BUTTON_DOWN",l.LEFT,this.left);Input.instance.unsubscribe("BUTTON_DOWN",l.RIGHT,this.right);this.scene.setParent(null);engine.removeEntity(this.scene);engine.removeSystem(this)}shareState({score:e,player:t,frogPosition:n,takenSammiches:i}){void 0;const{x:s,y:o,z:r}=n||{};this.ui.updateScore({score:e,player:t});this["screen"+t].setFrogPosition(s,o,r);this["screen"+t].setTakenSammiches(i)}finish({winner:e}){void 0;const t=1===e?2:1;this.roundResult1.show();this.roundResult2.show();this["roundResult"+e].update(1);this["roundResult"+t].update(0)}onFinish(e){this.callbacks.onFinish=e;return()=>this.callbacks.onFinish=null}onShareState(e){this.callbacks.onShareState=e;return()=>this.callbacks.onShareState=null}}t.FroggerGame=c;c.id="Frogger";c.instructions="cross the roads and\ntake all sammiches\npressing E F and CLICK"},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.createScreen=void 0;const i=n(0),s=n(1),o=n(10),r=n(3),a=n(2),l=n(46),c=4/128,h=36*-c,u={UP:ActionButton.POINTER,LEFT:ActionButton.PRIMARY,RIGHT:ActionButton.SECONDARY},d=[12*c-1.5+8*c/2,28*c-1.5+8*c/2,44*c-1.5+8*c/2,60*c-1.5+8*c/2,76*c-1.5+8*c/2],p=(e,{x:t,index:n})=>{let s=0;const o={onTake:null},r=i.createSpriteEntity(e,{position:new Vector3(t,2-15*c+8*c/2,-.001),scale:new Vector3(8*c,8*c,1),uvs:i.getSpriteUv(2,8448,8,8)}),l=()=>{s=1;r.getShape().visible=0},h=e=>{if(s)return 0;if(e.y<2-15*c)return 0;if(e.x===t){l();a.playOnce("ok");return 1}},u=undefined,d=undefined;return{spriteEntity:r,take:l,checkFrog:h,onTake:e=>{o.onTake=e;return()=>o.onTake=null},isTaken:()=>s,index:n}},m=5;t.createScreen=(e,{player:t,seed:n})=>{const g={blocked:0,lastKey:u.UP,movingFrog:0,countDt:0,frogPosition:new Vector3(0,0+h,-.009),score:0,takenSammiches:[0,0,0,0,0]},S=new Entity,y=new Entity;y.setParent(S);S.setParent(e);const f=r.seedGen.create(n),T=Array(9).fill(null).map((e,t)=>l.createCarPool(S,{track:t,randomizer:f})),b=[0,1,2,3,4],w=Array(m).fill(null).map((e,t)=>p(S,{x:d[b[t]],index:t}));S.addComponent(new Transform({position:new Vector3(1===t?-1.5:1.5,2,-0)}));y.addComponent(new Transform({scale:new Vector3(3,4,1)}));const v=new PlaneShape;v.uvs=i.getSpriteUv(9,11,96,128);y.addComponent(v);y.addComponent(s.spriteMaterial);const C=new i.SpriteAnimationSystem(S,{frames:[{uvs:i.getSpriteUv(1,8448,8,8)},{uvs:i.getSpriteUv(1,8576,8,8)}],scale:new Vector3(8*c,8*c,1),position:g.frogPosition,time:.1});C.init();const P=(e,t)=>{g.countDt+=e;T.forEach(t=>t.update(e));if(t){const e=C.getPosition(),t=w.find((t,n)=>{if(t.checkFrog(e))return{index:n}});if(t){g.takenSammiches[t.index]=1;g.score++;void 0;x.onStateChange&&x.onStateChange(g);return}T.forEach(t=>{if(t.isCollidingFrog(e)){a.playOnce("fail");g.blocked=1;setTimeout(()=>{g.blocked=0;e.set(0,h,e.z);x.onStateChange&&x.onStateChange(g)},200)}})}},R=undefined,E=e=>{if(g.movingFrog||g.blocked)return;a.playOnce("swing");g.movingFrog=1;C.setRotation(e===u.UP?0:e===u.LEFT?90:270);C.play([0,1,0],{loop:0,time:.1});const t=C.getPosition();C.addComponentOrReplace(new o.MoveTransformComponent(t,new Vector3(e===u.LEFT?t.x-8*c:e===u.RIGHT?t.x+8*c:t.x,e===u.UP?t.y+8*c:t.y,t.z),.1,()=>{g.movingFrog=0;const e=C.getPosition();if(e.y>=1.625)if((e.x+1.5)/(8*c)%2)e.y=h+8*c*10;else{g.blocked=1;setTimeout(()=>{g.blocked=0;e.set(e.x,h,e.z);g.frogPosition=e;x.onStateChange&&x.onStateChange(g)},300)}e.x<=8*c-1.5?e.x=8*c-1.5:e.x>=1.5-8*c&&(e.x=1.5-8*c);g.frogPosition=e;x.onStateChange&&x.onStateChange(g)}))},_=undefined,I=undefined,A=undefined,O=undefined,x={onStateChange:null},k=undefined,N=undefined;return{updateScreen:P,getScreenState:()=>g,up:()=>E(u.UP),left:()=>E(u.LEFT),right:()=>E(u.RIGHT),onStateChange:e=>{x.onStateChange=e;return()=>x.onStateChange=null},setFrogPosition:(e,t,n)=>{C.getPosition().set(e,t,n)},setTakenSammiches:e=>{void 0;e.forEach((e,t)=>g.takenSammiches[t]=e);w.forEach((t,n)=>{e[n]&&t.spriteEntity.hide()})},block:()=>g.blocked=1};function F(e,t,n,i){const s=Math.floor(e.random()*(n-t+1))+t;return i&&i.find(e=>e===s)?F(e,t,n,i):s}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:1});t.createCarPool=void 0;const i=4/128,s=36*-i,o=8*i,r=new Material;r.albedoColor=Color3.Blue();const a=new PlaneShape;t.createCarPool=(e,{track:t,randomizer:n})=>{const s=3,l={countDt:0,nextCarAt:Number.MAX_VALUE,currentPoolIndex:0},c=e=>e+1.5;let h,u=0;const d=Array(s).fill(null).reduce((e,t)=>{let s=3*n.random()-1.5;for(;!h&&e.find(e=>c(e)-c(s)<o+i);){s=3*n.random()-1.5;u++;if(u>1e4){void 0;h=1}}e.push(s);return e},[]),p=new Array(s).fill(null).map((n,s)=>{const l=new Entity,c=new Transform({position:new Vector3(d[s],28*-i+t*i*8+(t>=4?8*i:0),-.001),scale:new Vector3(o,4*i,.1)});l.addComponent(r);l.addComponent(a);l.addComponent(c);l.setParent(e);return{entity:l,transform:c,spawned:1}}),m=e=>Math.floor(1e3*e)/1e3,g=()=>{p.filter(e=>e.spawned).forEach(e=>{const t=e.transform.position.x;t>1.5-o/2||t<o/2-1.5?e.transform.scale.set(.01,e.transform.scale.y,e.transform.scale.z):e.transform.scale.set(o,e.transform.scale.y,e.transform.scale.z)})},S=e=>{p.filter(e=>e.spawned).forEach((n,i)=>{const s=n.transform.position.x;t%2==0?s<=-1.5?n.transform.position.set(1.5,n.transform.position.y,n.transform.position.z):n.transform.position.set(m(s-.5*e),n.transform.position.y,n.transform.position.z):s>=1.5?n.transform.position.set(-1.5,n.transform.position.y,n.transform.position.z):n.transform.position.set(m(s+.5*e),n.transform.position.y,n.transform.position.z)})},y=undefined,f=undefined;return{update:e=>{l.countDt+=e;S(e)},isCollidingFrog:e=>{const t=6*i,n=4*i,s=8*i;let o=p.length;for(;o--;){const i=p[o].transform.position,r=i.x-s/2,a=i.x+s/2,l=i.y+n/2,c=i.y-n/2,h=e.x-t/2,u=e.x+t/2,d=e.y-t/2,m=e.y+t/2;if(r<=u&&a>=h&&l<=m&&c>=d){void 0;return 1}}}}}}]));